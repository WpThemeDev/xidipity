!function(){"use strict";function n(n){return function(){return n}}function i(){return an}function t(t){return function(n){return function(n){if(null===n)return"null";var t=typeof n;return"object"==t&&Array.prototype.isPrototypeOf(n)?"array":"object"==t&&String.prototype.isPrototypeOf(n)?"string":t}(n)===t}}function e(n,t){return-1<fn(n,t)}function r(n,t){for(var e=n.length,r=new Array(e),o=0;o<e;o++){var i=n[o];r[o]=t(i,o,n)}return r}function o(n,t){for(var e=0,r=n.length;e<r;e++)t(n[e],e,n)}function u(n,t){for(var e=n.length-1;0<=e;e--)t(n[e],e,n)}function a(n,t){for(var e=[],r=0,o=n.length;r<o;r++){var i=n[r];t(i,r,n)&&e.push(i)}return e}function c(n,t){for(var e=0,r=n.length;e<r;e++)if(t(n[e],e,n))return ln.some(e);return ln.none()}function l(n){for(var t=[],e=0,r=n.length;e<r;++e){if(!Array.prototype.isPrototypeOf(n[e]))throw new Error("Arr.flatten item "+e+" was not an array, input: "+n);mn.apply(t,n[e])}return t}function s(n,t){for(var e=0,r=n.length;e<r;++e)if(!0!==t(n[e],e,n))return!1;return!0}function f(n,t){for(var e=vn(n),r=0,o=e.length;r<o;r++){var i=e[r];t(n[i],i,n)}}function d(r,o){var i={};return f(r,function(n,t){var e=o(n,t,r);i[e.k]=e.v}),i}function m(n,e){var r=[];return f(n,function(n,t){r.push(e(n,t))}),r}function g(n){return m(n,function(n){return n})}function p(n){return n.slice(0).sort()}function h(n,t){throw new Error("All required keys ("+p(n).join(", ")+") were not specified. Specified keys were: "+p(t).join(", ")+".")}function v(n){throw new Error("Unsupported keys for object: "+p(n).join(", "))}function b(t,n){if(!sn.isArray(n))throw new Error("The "+t+" fields must be an array. Was: "+n+".");hn.each(n,function(n){if(!sn.isString(n))throw new Error("The value "+n+" in the "+t+" fields was not a string.")})}function w(n){var e=p(n);hn.find(e,function(n,t){return t<e.length-1&&n===e[t+1]}).each(function(n){throw new Error("The field: "+n+" occurs more than once in the combined fields: ["+e.join(", ")+"].")})}function y(n){if(null==n)throw new Error("Node cannot be null or undefined");return{dom:rn.constant(n)}}function x(n){return 1!==n.nodeType&&9!==n.nodeType||0===n.childElementCount}function C(n,t){for(var e=[],r=function(n){return e.push(n),t(n)},o=t(n);(o=o.bind(r)).isSome(););return e}function R(n,t){return function(n,t){for(var e=null!=t?t:Nn,r=0;r<n.length&&null!=e;++r)e=e[n[r]];return e}(n.split("."),t)}function S(){return function(n,t){var e=R(n,t);if(null==e)throw n+" not available on this browser";return e}("Node")}function T(n){var t,e=!1;return function(){return e||(e=!0,t=n.apply(null,arguments)),t}}function D(){return On(0,0)}function k(n,t){return function(){return t===n}}function A(n){var t=n.current;return{current:t,version:n.version,isEdge:k("Edge",t),isChrome:k("Chrome",t),isIE:k("IE",t),isOpera:k("Opera",t),isFirefox:k(Bn,t),isSafari:k("Safari",t)}}function N(n,t){return function(){return t===n}}function O(n){var t=n.current;return{current:t,version:n.version,isWindows:N(Wn,t),isiOS:N("iOS",t),isAndroid:N(jn,t),isOSX:N("OSX",t),isLinux:N("Linux",t),isSolaris:N(qn,t),isFreeBSD:N(Hn,t)}}function I(n,t){var e=String(t).toLowerCase();return hn.find(n,function(n){return n.search(e)})}function P(n,t,e){return""===t||!(n.length<t.length)&&n.substr(e,e+t.length)===t}function B(n,t){return P(n,t,n.length-t.length)}function E(t){return function(n){return Fn(n,t)}}function M(n){var t,e,r,o,i,u,a,c,l,s,f,d=Jn.browsers(),m=Jn.oses(),g=function(n,e){return I(n,e).map(function(n){var t=In(n.versionRegexes,e);return{current:n.name,version:t}})}(d,n).fold(En,Mn),p=function(n,e){return I(n,e).map(function(n){var t=In(n.versionRegexes,e);return{current:n.name,version:t}})}(m,n).fold(Ln,zn);return{browser:g,os:p,deviceType:(e=g,r=n,o=(t=p).isiOS()&&!0===/ipad/i.test(r),i=t.isiOS()&&!o,u=t.isAndroid()&&3===t.version.major,a=t.isAndroid()&&4===t.version.major,c=o||u||a&&!0===/mobile/i.test(r),l=t.isiOS()||t.isAndroid(),s=l&&!c,f=e.isSafari()&&t.isiOS()&&!1===/safari/i.test(r),{isiPad:rn.constant(o),isiPhone:rn.constant(i),isTablet:rn.constant(c),isPhone:rn.constant(s),isTouch:rn.constant(l),isAndroid:t.isAndroid,isiOS:t.isiOS,isWebView:rn.constant(f)})}}function W(n,t){return n.dom()===t.dom()}function j(n){return kn.fromDom(n.dom().ownerDocument)}function q(n){var t=n.dom();return ln.from(t.parentNode).map(kn.fromDom)}function H(n){var t=n.dom();return ln.from(t.previousSibling).map(kn.fromDom)}function L(n){var t=n.dom();return ln.from(t.nextSibling).map(kn.fromDom)}function z(n){var t=n.dom();return hn.map(t.childNodes,kn.fromDom)}function _(n,t){var e=n.dom().childNodes;return ln.from(e[t]).map(kn.fromDom)}function F(n){return n.dom().nodeName.toLowerCase()}function V(n){return n.dom().nodeType}function U(t){return function(n){return V(n)===t}}function G(n,t,e){if(!(sn.isString(e)||sn.isBoolean(e)||sn.isNumber(e)))throw console.error("Invalid call to Attr.set. Key ",t,":: Value ",e,":: Element ",n),new Error("Attribute value was not simple");n.setAttribute(t,e+"")}function Y(n,t,e){G(n.dom(),t,e)}function J(n,t){var e=n.dom().getAttribute(t);return null===e?void 0:e}function X(n,t){var e=n.dom();return!(!e||!e.hasAttribute)&&e.hasAttribute(t)}var K,Z,$,Q,nn,tn,en=tinymce.util.Tools.resolve("tinymce.PluginManager"),rn={noop:function(){for(var n=[],t=0;t<arguments.length;t++)n[t]=arguments[t]},noarg:function(e){return function(){for(var n=[],t=0;t<arguments.length;t++)n[t]=arguments[t];return e()}},compose:function(e,r){return function(){for(var n=[],t=0;t<arguments.length;t++)n[t]=arguments[t];return e(r.apply(null,arguments))}},constant:n,identity:function(n){return n},tripleEquals:function(n,t){return n===t},curry:function(i){for(var n=[],t=1;t<arguments.length;t++)n[t-1]=arguments[t];for(var u=new Array(arguments.length-1),e=1;e<arguments.length;e++)u[e-1]=arguments[e];return function(){for(var n=[],t=0;t<arguments.length;t++)n[t]=arguments[t];for(var e=new Array(arguments.length),r=0;r<e.length;r++)e[r]=arguments[r];var o=u.concat(e);return i.apply(null,o)}},not:function(e){return function(){for(var n=[],t=0;t<arguments.length;t++)n[t]=arguments[t];return!e.apply(null,arguments)}},die:function(n){return function(){throw new Error(n)}},apply:function(n){return n()},call:function(n){n()},never:n(!1),always:n(!0)},on=rn.never,un=rn.always,an=(Q={fold:function(n,t){return n()},is:on,isSome:on,isNone:un,getOr:$=function(n){return n},getOrThunk:Z=function(n){return n()},getOrDie:function(n){throw new Error(n||"error: getOrDie called on none.")},or:$,orThunk:Z,map:i,ap:i,each:function(){},bind:i,flatten:i,exists:on,forall:un,filter:i,equals:K=function(n){return n.isNone()},equals_:K,toArray:function(){return[]},toString:rn.constant("none()")},Object.freeze&&Object.freeze(Q),Q),cn=function(e){function n(){return e}function t(){return o}function r(n){return n(e)}var o={fold:function(n,t){return t(e)},is:function(n){return e===n},isSome:un,isNone:on,getOr:n,getOrThunk:n,getOrDie:n,or:t,orThunk:t,map:function(n){return cn(n(e))},ap:function(n){return n.fold(i,function(n){return cn(n(e))})},each:function(n){n(e)},bind:r,flatten:n,exists:r,forall:r,filter:function(n){return n(e)?o:an},equals:function(n){return n.is(e)},equals_:function(n,t){return n.fold(on,function(n){return t(e,n)})},toArray:function(){return[e]},toString:function(){return"some("+e+")"}};return o},ln={some:cn,none:i,from:function(n){return null==n?an:cn(n)}},sn={isString:t("string"),isObject:t("object"),isArray:t("array"),isNull:t("null"),isBoolean:t("boolean"),isUndefined:t("undefined"),isFunction:t("function"),isNumber:t("number")},fn=void 0===(nn=Array.prototype.indexOf)?function(n,t){return dn(n,t)}:function(n,t){return nn.call(n,t)},dn=function(n,t){for(var e=0,r=n.length;e<r;++e)if(n[e]===t)return e;return-1},mn=Array.prototype.push,gn=Array.prototype.slice,pn=sn.isFunction(Array.from)?Array.from:function(n){return gn.call(n)},hn={map:r,each:o,eachr:u,partition:function(n,t){for(var e=[],r=[],o=0,i=n.length;o<i;o++){var u=n[o];(t(u,o,n)?e:r).push(u)}return{pass:e,fail:r}},filter:a,groupBy:function(n,t){if(0===n.length)return[];for(var e=t(n[0]),r=[],o=[],i=0,u=n.length;i<u;i++){var a=n[i],c=t(a);c!==e&&(r.push(o),o=[]),e=c,o.push(a)}return 0!==o.length&&r.push(o),r},indexOf:function(n,t){var e=fn(n,t);return-1===e?ln.none():ln.some(e)},foldr:function(n,t,e){return u(n,function(n){e=t(e,n)}),e},foldl:function(n,t,e){return o(n,function(n){e=t(e,n)}),e},find:function(n,t){for(var e=0,r=n.length;e<r;e++){var o=n[e];if(t(o,e,n))return ln.some(o)}return ln.none()},findIndex:c,flatten:l,bind:function(n,t){var e=r(n,t);return l(e)},forall:s,exists:function(n,t){return c(n,t).isSome()},contains:e,equal:function(n,e){return n.length===e.length&&s(n,function(n,t){return n===e[t]})},reverse:function(n){var t=gn.call(n,0);return t.reverse(),t},chunk:function(n,t){for(var e=[],r=0;r<n.length;r+=t){var o=n.slice(r,r+t);e.push(o)}return e},difference:function(n,t){return a(n,function(n){return!e(t,n)})},mapToObject:function(n,t){for(var e={},r=0,o=n.length;r<o;r++){var i=n[r];e[String(i)]=t(i,r)}return e},pure:function(n){return[n]},sort:function(n,t){var e=gn.call(n,0);return e.sort(t),e},range:function(n,t){for(var e=[],r=0;r<n;r++)e.push(t(r));return e},head:function(n){return 0===n.length?ln.none():ln.some(n[0])},last:function(n){return 0===n.length?ln.none():ln.some(n[n.length-1])},from:pn},vn=void 0===(tn=Object.keys)?function(n){var t=[];for(var e in n)n.hasOwnProperty(e)&&t.push(e);return t}:tn,bn={bifilter:function(n,e){var r={},o={};return f(n,function(n,t){(e(n,t)?r:o)[t]=n}),{t:r,f:o}},each:f,map:function(n,r){return d(n,function(n,t,e){return{k:t,v:r(n,t,e)}})},mapToArray:m,tupleMap:d,find:function(n,t){for(var e=vn(n),r=0,o=e.length;r<o;r++){var i=e[r],u=n[i];if(t(u,i,n))return ln.some(u)}return ln.none()},keys:vn,values:g,size:function(n){return g(n).length}},wn={immutable:function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];if(t.length!==e.length)throw new Error('Wrong number of arguments to struct. Expected "['+t.length+']", got '+e.length+" arguments");var r={};return hn.each(t,function(n,t){r[n]=rn.constant(e[t])}),r}},immutableBag:function(o,i){var u=o.concat(i);if(0===u.length)throw new Error("You must specify at least one required or optional field.");return b("required",o),b("optional",i),w(u),function(t){var e=bn.keys(t);hn.forall(o,function(n){return hn.contains(e,n)})||h(o,e);var n=hn.filter(e,function(n){return!hn.contains(u,n)});0<n.length&&v(n);var r={};return hn.each(o,function(n){r[n]=rn.constant(t[n])}),hn.each(i,function(n){r[n]=rn.constant(Object.prototype.hasOwnProperty.call(t,n)?ln.some(t[n]):ln.none())}),r}}},yn=wn.immutable("width","height"),xn=wn.immutable("rows","columns"),Cn=wn.immutable("row","column"),Rn=wn.immutable("x","y"),Sn=wn.immutable("element","rowspan","colspan"),Tn=wn.immutable("element","rowspan","colspan","isNew"),Dn={dimensions:yn,grid:xn,address:Cn,coords:Rn,extended:wn.immutable("element","rowspan","colspan","row","column"),detail:Sn,detailnew:Tn,rowdata:wn.immutable("element","cells","section"),elementnew:wn.immutable("element","isNew"),rowdatanew:wn.immutable("element","cells","section","isNew"),rowcells:wn.immutable("cells","section"),rowdetails:wn.immutable("details","section"),bounds:wn.immutable("startRow","startCol","finishRow","finishCol")},kn={fromHtml:function(n,t){var e=(t||document).createElement("div");if(e.innerHTML=n,!e.hasChildNodes()||1<e.childNodes.length)throw console.error("HTML does not have a single root node",n),"HTML must have a single root node";return y(e.childNodes[0])},fromTag:function(n,t){var e=(t||document).createElement(n);return y(e)},fromText:function(n,t){var e=(t||document).createTextNode(n);return y(e)},fromDom:y,fromPoint:function(n,t,e){return ln.from(n.dom().elementFromPoint(t,e)).map(y)}},An={all:function(n,t){var e=void 0===t?document:t.dom();return x(e)?[]:hn.map(e.querySelectorAll(n),kn.fromDom)},is:function(n,t){var e=n.dom();if(1!==e.nodeType)return!1;if(void 0!==e.matches)return e.matches(t);if(void 0!==e.msMatchesSelector)return e.msMatchesSelector(t);if(void 0!==e.webkitMatchesSelector)return e.webkitMatchesSelector(t);if(void 0!==e.mozMatchesSelector)return e.mozMatchesSelector(t);throw new Error("Browser lacks native selectors")},one:function(n,t){var e=void 0===t?document:t.dom();return x(e)?ln.none():ln.from(e.querySelector(n)).map(kn.fromDom)}},Nn="undefined"!=typeof window?window:Function("return this;")(),On=function(n,t){return{major:n,minor:t}},In=function(n,t){var e=String(t).toLowerCase();return 0===n.length?D():function(n,t){var e=function(n,t){for(var e=0;e<n.length;e++){var r=n[e];if(r.test(t))return r}}(n,t);if(!e)return{major:0,minor:0};function r(n){return Number(t.replace(e,"$"+n))}return On(r(1),r(2))}(n,e)},Pn=D,Bn="Firefox",En=function(){return A({current:void 0,version:Pn()})},Mn=A,Wn=(rn.constant("Edge"),rn.constant("Chrome"),rn.constant("IE"),rn.constant("Opera"),rn.constant(Bn),rn.constant("Safari"),"Windows"),jn="Android",qn="Solaris",Hn="FreeBSD",Ln=function(){return O({current:void 0,version:Pn()})},zn=O,_n=(rn.constant(Wn),rn.constant("iOS"),rn.constant(jn),rn.constant("Linux"),rn.constant("OSX"),rn.constant(qn),rn.constant(Hn),B),Fn=function(n,t){return-1!==n.indexOf(t)},Vn=function(n){return n.replace(/^\s+|\s+$/g,"")},Un=/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,Gn=[{name:"Edge",versionRegexes:[/.*?edge\/ ?([0-9]+)\.([0-9]+)$/],search:function(n){return Fn(n,"edge/")&&Fn(n,"chrome")&&Fn(n,"safari")&&Fn(n,"applewebkit")}},{name:"Chrome",versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/,Un],search:function(n){return Fn(n,"chrome")&&!Fn(n,"chromeframe")}},{name:"IE",versionRegexes:[/.*?msie\ ?([0-9]+)\.([0-9]+).*/,/.*?rv:([0-9]+)\.([0-9]+).*/],search:function(n){return Fn(n,"msie")||Fn(n,"trident")}},{name:"Opera",versionRegexes:[Un,/.*?opera\/([0-9]+)\.([0-9]+).*/],search:E("opera")},{name:"Firefox",versionRegexes:[/.*?firefox\/\ ?([0-9]+)\.([0-9]+).*/],search:E("firefox")},{name:"Safari",versionRegexes:[Un,/.*?cpu os ([0-9]+)_([0-9]+).*/],search:function(n){return(Fn(n,"safari")||Fn(n,"mobile/"))&&Fn(n,"applewebkit")}}],Yn=[{name:"Windows",search:E("win"),versionRegexes:[/.*?windows\ nt\ ?([0-9]+)\.([0-9]+).*/]},{name:"iOS",search:function(n){return Fn(n,"iphone")||Fn(n,"ipad")},versionRegexes:[/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,/.*cpu os ([0-9]+)_([0-9]+).*/,/.*cpu iphone os ([0-9]+)_([0-9]+).*/]},{name:"Android",search:E("android"),versionRegexes:[/.*?android\ ?([0-9]+)\.([0-9]+).*/]},{name:"OSX",search:E("os x"),versionRegexes:[/.*?os\ x\ ?([0-9]+)_([0-9]+).*/]},{name:"Linux",search:E("linux"),versionRegexes:[]},{name:"Solaris",search:E("sunos"),versionRegexes:[]},{name:"FreeBSD",search:E("freebsd"),versionRegexes:[]}],Jn={browsers:rn.constant(Gn),oses:rn.constant(Yn)},Xn={detect:T(function(){var n=navigator.userAgent;return M(n)})},Kn=Xn.detect().browser.isIE()?function(n,t){return function(n,t){return function(n,t,e){return 0!=(n.compareDocumentPosition(t)&e)}(n,t,S().DOCUMENT_POSITION_CONTAINED_BY)}(n.dom(),t.dom())}:function(n,t){var e=n.dom(),r=t.dom();return e!==r&&e.contains(r)},Zn={eq:W,isEqualNode:function(n,t){return n.dom().isEqualNode(t.dom())},member:function(n,t){return hn.exists(t,rn.curry(W,n))},contains:Kn,is:An.is},$n=wn.immutable("element","offset"),Qn={owner:j,defaultView:function(n){var t=n.dom().ownerDocument.defaultView;return kn.fromDom(t)},documentElement:function(n){var t=j(n);return kn.fromDom(t.dom().documentElement)},parent:q,findIndex:function(e){return q(e).bind(function(n){var t=z(n);return hn.findIndex(t,function(n){return Zn.eq(e,n)})})},parents:function(n,t){for(var e=sn.isFunction(t)?t:rn.constant(!1),r=n.dom(),o=[];null!==r.parentNode&&void 0!==r.parentNode;){var i=r.parentNode,u=kn.fromDom(i);if(o.push(u),!0===e(u))break;r=i}return o},siblings:function(t){return q(t).map(z).map(function(n){return hn.filter(n,function(n){return!Zn.eq(t,n)})}).getOr([])},prevSibling:H,offsetParent:function(n){var t=n.dom();return ln.from(t.offsetParent).map(kn.fromDom)},prevSiblings:function(n){return hn.reverse(C(n,H))},nextSibling:L,nextSiblings:function(n){return C(n,L)},children:z,child:_,firstChild:function(n){return _(n,0)},lastChild:function(n){return _(n,n.dom().childNodes.length-1)},childNodesCount:function(n){return n.dom().childNodes.length},hasChildNodes:function(n){return n.dom().hasChildNodes()},leaf:function(n,t){var e=z(n);return 0<e.length&&t<e.length?$n(e[t],0):$n(n,t)}},nt=function(n,t,e){return hn.bind(Qn.children(n),function(n){return An.is(n,t)?e(n)?[n]:[]:nt(n,t,e)})},tt={firstLayer:function(n,t){return nt(n,t,rn.constant(!0))},filterFirstLayer:nt},et=U(1),rt=U(3),ot=U(9),it={name:F,type:V,value:function(n){return n.dom().nodeValue},isElement:et,isText:rt,isDocument:ot,isComment:function(n){return 8===V(n)||"#comment"===F(n)}},ut={clone:function(n){return hn.foldl(n.dom().attributes,function(n,t){return n[t.name]=t.value,n},{})},set:Y,setAll:function(n,t){var e=n.dom();bn.each(t,function(n,t){G(e,t,n)})},get:J,has:X,remove:function(n,t){n.dom().removeAttribute(t)},hasNone:function(n){var t=n.dom().attributes;return null==t||0===t.length},transfer:function(o,i,n){it.isElement(o)&&it.isElement(i)&&hn.each(n,function(n){var t,e,r;e=i,X(t=o,r=n)&&!X(e,r)&&Y(e,r,J(t,r))})}},at=T(function(){return ct(kn.fromDom(document))}),ct=function(n){var t=n.dom().body;if(null==t)throw"Body is not available yet";return kn.fromDom(t)},lt={body:at,getBody:ct,inBody:function(n){var t=it.isText(n)?n.dom().parentNode:n.dom();return null!=t&&t.ownerDocument.body.contains(t)}},st=function(n,t){var e=[];return hn.each(Qn.children(n),function(n){t(n)&&(e=e.concat([n])),e=e.concat(st(n,t))}),e},ft={all:function(n){return st(lt.body(),n)},ancestors:function(n,t,e){return hn.filter(Qn.parents(n,e),t)},siblings:function(n,t){return hn.filter(Qn.siblings(n),t)},children:function(n,t){return hn.filter(Qn.children(n),t)},descendants:st},dt={all:function(n){return An.all(n)},ancestors:function(n,t,e){return ft.ancestors(n,function(n){return An.is(n,t)},e)},siblings:function(n,t){return ft.siblings(n,function(n){return An.is(n,t)})},children:function(n,t){return ft.children(n,function(n){return An.is(n,t)})},descendants:function(n,t){return An.all(t,n)}};function mt(n,t,e,r,o){return n(e,r)?ln.some(e):sn.isFunction(o)&&o(e)?ln.none():t(e,r,o)}function gt(n,t,e){for(var r=n.dom(),o=sn.isFunction(e)?e:rn.constant(!1);r.parentNode;){r=r.parentNode;var i=kn.fromDom(r);if(t(i))return ln.some(i);if(o(i))break}return ln.none()}function pt(n,t){return hn.find(n.dom().childNodes,rn.compose(t,kn.fromDom)).map(kn.fromDom)}function ht(n,r){var o=function(n){for(var t=0;t<n.childNodes.length;t++){if(r(kn.fromDom(n.childNodes[t])))return ln.some(kn.fromDom(n.childNodes[t]));var e=o(n.childNodes[t]);if(e.isSome())return e}return ln.none()};return o(n.dom())}function vt(n,t,e){return Yt.ancestor(n,function(n){return An.is(n,t)},e)}function bt(n,t,e){var r=void 0!==e?e:rn.constant(!1);return r(t)?ln.none():hn.contains(n,it.name(t))?ln.some(t):Jt.ancestor(t,n.join(","),function(n){return An.is(n,"table")||r(n)})}function wt(t,n){return Qn.parent(n).map(function(n){return dt.children(n,t)})}function yt(n){var t=$t(n);return hn.map(t,function(n){var t=n,e=Qn.parent(t).bind(function(n){var t=it.name(n);return"tfoot"===t||"thead"===t||"tbody"===t?t:"tbody"}),r=hn.map(Kt(n),function(n){var t=ut.has(n,"rowspan")?parseInt(ut.get(n,"rowspan"),10):1,e=ut.has(n,"colspan")?parseInt(ut.get(n,"colspan"),10):1;return Dn.detail(n,t,e)});return Dn.rowdata(t,r,e)})}function xt(n,t){return n+","+t}function Ct(n,t){var e=hn.bind(n.all(),function(n){return n.cells()});return hn.filter(e,t)}function Rt(n){return void 0!==n.style}function St(n,t,e){if(!sn.isString(e))throw console.error("Invalid call to CSS.set. Property ",t,":: Value ",e,":: Element ",n),new Error("CSS value must be a string: "+e);Rt(n)&&n.style.setProperty(t,e)}function Tt(n,t){Rt(n)&&n.style.removeProperty(t)}function Dt(n,t,e){var r=n.dom();St(r,t,e)}function kt(n,t){return Rt(n)?n.style.getPropertyValue(t):""}function At(n,t){var e=n.dom(),r=kt(e,t);return ln.from(r).filter(function(n){return 0<n.length})}function Nt(t,e){Qn.parent(t).each(function(n){n.dom().insertBefore(e.dom(),t.dom())})}function Ot(n,t){n.dom().appendChild(t.dom())}function It(n){var t=n.dom();null!==t.parentNode&&t.parentNode.removeChild(t)}function Pt(n,t){return kn.fromDom(n.dom().cloneNode(t))}function Bt(n){return Pt(n,!0)}function Et(n){return Pt(n,!1)}function Mt(n,t){var e=function(n,t){var e=kn.fromTag(t),r=ut.clone(n);return ut.setAll(e,r),e}(n,t),r=Qn.children(Bt(n));return ue.append(e,r),e}function Wt(n){return fe.getOption(n).filter(function(n){return 0!==n.trim().length||-1<n.indexOf("Â ")}).isSome()||hn.contains(de,it.name(n))}function jt(){var n=kn.fromTag("td");return ie.append(n,kn.fromTag("br")),n}function qt(n,t,e){var r=Mt(n,t);return bn.each(e,function(n,t){null===n?ut.remove(r,t):ut.set(r,t,n)}),r}function Ht(n){return n}function Lt(n){return function(){return kn.fromTag("tr",n.dom())}}function zt(c,n,l){return{row:Lt(n),cell:function(n){var r,o,i,t=Qn.owner(n.element()),e=kn.fromTag(it.name(n.element()),t.dom()),u=l.getOr(["strong","em","b","i","span","font","h1","h2","h3","h4","h5","h6","p","div"]),a=0<u.length?(r=n.element(),o=e,i=u,ge(r).map(function(n){var t=i.join(","),e=dt.ancestors(n,t,function(n){return Zn.eq(n,r)});return hn.foldr(e,function(n,t){var e=Et(t);return ie.append(n,e),e},o)}).getOr(o)):e;return ie.append(a,kn.fromTag("br")),oe.copy(n.element(),e),oe.remove(e,"height"),1!==n.colspan()&&oe.remove(n.element(),"width"),c(n.element(),e),e},replace:qt,gap:jt}}function _t(n){return{row:Lt(n),cell:jt,replace:Ht,gap:jt}}var Ft,Vt,Ut,Gt,Yt={first:function(n){return ht(lt.body(),n)},ancestor:gt,closest:function(n,t,e){return mt(function(n){return t(n)},gt,n,t,e)},sibling:function(t,e){var n=t.dom();return n.parentNode?pt(kn.fromDom(n.parentNode),function(n){return!Zn.eq(t,n)&&e(n)}):ln.none()},child:pt,descendant:ht},Jt={first:function(n){return An.one(n)},ancestor:vt,sibling:function(n,t){return Yt.sibling(n,function(n){return An.is(n,t)})},child:function(n,t){return Yt.child(n,function(n){return An.is(n,t)})},descendant:function(n,t){return An.one(t,n)},closest:function(n,t,e){return mt(An.is,vt,n,t,e)}},Xt=(rn.curry(wt,"th,td"),rn.curry(wt,"tr"),function(n,t){return bt(["td","th"],n,t)}),Kt=function(n){return tt.firstLayer(n,"th,td")},Zt=function(n,t){return Jt.closest(n,"table",t)},$t=function(n){return tt.firstLayer(n,"tr")},Qt=function(n){var s={},t=[],e=n.length,f=0;hn.each(n,function(n,c){var l=[];hn.each(n.cells(),function(n,t){for(var e=0;void 0!==s[xt(c,e)];)e++;for(var r=Dn.extended(n.element(),n.rowspan(),n.colspan(),c,e),o=0;o<n.colspan();o++)for(var i=0;i<n.rowspan();i++){var u=e+o,a=xt(c+i,u);s[a]=r,f=Math.max(f,u+1)}l.push(r)}),t.push(Dn.rowdata(n.element(),l,n.section()))});var r=Dn.grid(e,f);return{grid:rn.constant(r),access:rn.constant(s),all:rn.constant(t)}},ne=function(n,t,e){var r=n.access()[xt(t,e)];return void 0!==r?ln.some(r):ln.none()},te=function(n,t,e){var r=Ct(n,function(n){return e(t,n.element())});return 0<r.length?ln.some(r[0]):ln.none()},ee=Ct,re=function(n){var t=hn.map(n.all(),function(n){return n.cells()});return hn.flatten(t)},oe={copy:function(n,t){var e=n.dom(),r=t.dom();Rt(e)&&Rt(r)&&(r.style.cssText=e.style.cssText)},set:Dt,preserve:function(n,t){var e=ut.get(n,"style"),r=t(n);return(void 0===e?ut.remove:ut.set)(n,"style",e),r},setAll:function(n,t){var e=n.dom();bn.each(t,function(n,t){St(e,t,n)})},setOptions:function(n,t){var e=n.dom();bn.each(t,function(n,t){n.fold(function(){Tt(e,t)},function(n){St(e,t,n)})})},remove:function(n,t){var e=n.dom();Tt(e,t),ut.has(n,"style")&&""===Vn(ut.get(n,"style"))&&ut.remove(n,"style")},get:function(n,t){var e=n.dom(),r=window.getComputedStyle(e).getPropertyValue(t),o=""!==r||lt.inBody(n)?r:kt(e,t);return null===o?void 0:o},getRaw:At,getAllRaw:function(n){var t={},e=n.dom();if(Rt(e))for(var r=0;r<e.style.length;r++){var o=e.style.item(r);t[o]=e.style[o]}return t},isValidValue:function(n,t,e){var r=kn.fromTag(n);return Dt(r,t,e),At(r,t).isSome()},reflow:function(n){return n.dom().offsetWidth},transfer:function(r,o,n){it.isElement(r)&&it.isElement(o)&&hn.each(n,function(n){var t,e;t=o,At(r,e=n).each(function(n){At(t,e).isNone()&&Dt(t,e,n)})})}},ie={before:Nt,after:function(n,t){Qn.nextSibling(n).fold(function(){Qn.parent(n).each(function(n){Ot(n,t)})},function(n){Nt(n,t)})},prepend:function(t,e){Qn.firstChild(t).fold(function(){Ot(t,e)},function(n){t.dom().insertBefore(e.dom(),n.dom())})},append:Ot,appendAt:function(n,t,e){Qn.child(n,e).fold(function(){Ot(n,t)},function(n){Nt(n,t)})},wrap:function(n,t){Nt(n,t),Ot(t,n)}},ue={before:function(t,n){hn.each(n,function(n){ie.before(t,n)})},after:function(r,o){hn.each(o,function(n,t){var e=0===t?r:o[t-1];ie.after(e,n)})},prepend:function(t,n){hn.each(n.slice().reverse(),function(n){ie.prepend(t,n)})},append:function(t,n){hn.each(n,function(n){ie.append(t,n)})}},ae={empty:function(n){n.dom().textContent="",hn.each(Qn.children(n),function(n){It(n)})},remove:It,unwrap:function(n){var t=Qn.children(n);0<t.length&&ue.before(n,t),It(n)}},ce=wn.immutable("minRow","minCol","maxRow","maxCol"),le=Bt,se=(Ft=it.isText,"text",Vt=function(n){return Ft(n)?ln.from(n.dom().nodeValue):ln.none()},Ut=Xn.detect().browser,{get:function(n){if(!Ft(n))throw new Error("Can only get text value of a text node");return Gt(n).getOr("")},getOption:Gt=Ut.isIE()&&10===Ut.version.major?function(n){try{return Vt(n)}catch(n){return ln.none()}}:Vt,set:function(n,t){if(!Ft(n))throw new Error("Can only set raw text value of a text node");n.dom().nodeValue=t}}),fe={get:function(n){return se.get(n)},getOption:function(n){return se.getOption(n)},set:function(n,t){se.set(n,t)}},de=["img","br"],me=function(n){return"img"===it.name(n)?1:fe.getOption(n).fold(function(){return Qn.children(n).length},function(n){return n.length})},ge=function(n){return Yt.descendant(n,Wt)},pe=function(n){return function(n,i){var u=function(n){for(var t=Qn.children(n),e=t.length-1;0<=e;e--){var r=t[e];if(i(r))return ln.some(r);var o=u(r);if(o.isSome())return o}return ln.none()};return u(n)}(n,Wt)},he=["body","p","div","article","aside","figcaption","figure","footer","header","nav","section","ol","ul","li","table","thead","tbody","tfoot","caption","tr","td","th","h1","h2","h3","h4","h5","h6","blockquote","pre","address"];function ve(){return{up:rn.constant({selector:Jt.ancestor,closest:Jt.closest,predicate:Yt.ancestor,all:Qn.parents}),down:rn.constant({selector:dt.descendants,predicate:ft.descendants}),styles:rn.constant({get:oe.get,getRaw:oe.getRaw,set:oe.set,remove:oe.remove}),attrs:rn.constant({get:ut.get,set:ut.set,remove:ut.remove,copyTo:function(n,t){var e=ut.clone(n);ut.setAll(t,e)}}),insert:rn.constant({before:ie.before,after:ie.after,afterAll:ue.after,append:ie.append,appendAll:ue.append,prepend:ie.prepend,wrap:ie.wrap}),remove:rn.constant({unwrap:ae.unwrap,remove:ae.remove}),create:rn.constant({nu:kn.fromTag,clone:function(n){return kn.fromDom(n.dom().cloneNode(!1))},text:kn.fromText}),query:rn.constant({comparePosition:function(n,t){return n.dom().compareDocumentPosition(t.dom())},prevSibling:Qn.prevSibling,nextSibling:Qn.nextSibling}),property:rn.constant({children:Qn.children,name:it.name,parent:Qn.parent,isText:it.isText,isComment:it.isComment,isElement:it.isElement,getText:fe.get,setText:fe.set,isBoundary:function(n){return!!it.isElement(n)&&("body"===it.name(n)||hn.contains(he,it.name(n)))},isEmptyTag:function(n){return!!it.isElement(n)&&hn.contains(["br","img","hr","input"],it.name(n))}}),eq:Zn.eq,is:Zn.is}}wn.immutable("left","right");function be(n,t,e){return 0<e.length?function(r,o,n,t){var e=o(r,n);return hn.foldr(t,function(n,t){var e=o(r,t);return He(r,n,e)},e)}(n,t,(r=e)[0],r.slice(1)):ln.none();var r}function we(n,t){return rn.curry(n.eq,t)}function ye(t,n,e,r){function o(t){return hn.findIndex(t,i).fold(function(){return t},function(n){return t.slice(0,n+1)})}var i=void 0!==r?r:rn.constant(!1),u=[n].concat(t.up().all(n)),a=[e].concat(t.up().all(e)),c=o(u),l=o(a),s=hn.find(c,function(n){return hn.exists(l,we(t,n))});return{firstpath:rn.constant(c),secondpath:rn.constant(l),shared:rn.constant(s)}}function xe(n,t){return t.column()>=n.startCol()&&t.column()+t.colspan()-1<=n.finishCol()&&t.row()>=n.startRow()&&t.row()+t.rowspan()-1<=n.finishRow()}function Ce(n,t){var e=t.column(),r=t.column()+t.colspan()-1,o=t.row(),i=t.row()+t.rowspan()-1;return e<=n.finishCol()&&r>=n.startCol()&&o<=n.finishRow()&&i>=n.startRow()}function Re(n,t,e){var r=te(n,t,Zn.eq),o=te(n,e,Zn.eq);return r.bind(function(r){return o.map(function(n){return t=r,e=n,Dn.bounds(Math.min(t.row(),e.row()),Math.min(t.column(),e.column()),Math.max(t.row()+t.rowspan()-1,e.row()+e.rowspan()-1),Math.max(t.column()+t.colspan()-1,e.column()+e.colspan()-1));var t,e})})}function Se(t,n,e){return Re(t,n,e).bind(function(n){return function(n,t){for(var e=!0,r=rn.curry(xe,t),o=t.startRow();o<=t.finishRow();o++)for(var i=t.startCol();i<=t.finishCol();i++)e=e&&ne(n,o,i).exists(r);return e?ln.some(t):ln.none()}(t,n)})}function Te(e,n,t){return Ve(e,n,t).map(function(n){var t=ee(e,rn.curry(Ce,n));return hn.map(t,function(n){return n.element()})})}function De(n,t){return te(n,t,function(n,t){return Zn.contains(t,n)}).bind(function(n){return n.element()})}function ke(n){var t=yt(n);return Qt(t)}function Ae(t,e,r){return Zt(t).bind(function(n){return function(r,n,o,i){return te(r,n,Zn.eq).bind(function(n){var t=0<o?n.row()+n.rowspan()-1:n.row(),e=0<i?n.column()+n.colspan()-1:n.column();return ne(r,t+o,e+i).map(function(n){return n.element()})})}(ke(n),t,e,r)})}function Ne(n,t,e,r,o){var i=ke(n),u=Zn.eq(n,e)?t:De(i,t),a=Zn.eq(n,o)?r:De(i,r);return Te(i,u,a)}function Oe(n,t){return Jt.ancestor(n,"table")}function Ie(a,c,r){function l(t){return function(n){return r(n)||Zn.eq(n,t)}}return Zn.eq(a,c)?ln.some(Ue({boxes:ln.some([a]),start:a,finish:c})):Oe(a).bind(function(u){return Oe(c).bind(function(i){if(Zn.eq(u,i))return ln.some(Ue({boxes:function(n,t,e){var r=ke(n);return Te(r,t,e)}(u,a,c),start:a,finish:c}));if(Zn.contains(u,i)){var n=0<(t=dt.ancestors(c,"td,th",l(u))).length?t[t.length-1]:c;return ln.some(Ue({boxes:Ne(u,a,u,c,i),start:a,finish:n}))}if(Zn.contains(i,u)){var t,e=0<(t=dt.ancestors(a,"td,th",l(i))).length?t[t.length-1]:a;return ln.some(Ue({boxes:Ne(i,a,u,c,i),start:a,finish:e}))}return Fe(a,c).shared().bind(function(n){return Jt.closest(n,"table",r).bind(function(n){var t=dt.ancestors(c,"td,th",l(n)),e=0<t.length?t[t.length-1]:c,r=dt.ancestors(a,"td,th",l(n)),o=0<r.length?r[r.length-1]:a;return ln.some(Ue({boxes:Ne(n,a,u,c,i),start:o,finish:e}))})})})})}function Pe(n,t){var e=dt.descendants(n,t);return 0<e.length?ln.some(e):ln.none()}function Be(n,t,r){return Jt.descendant(n,t).bind(function(e){return Jt.descendant(n,r).bind(function(t){return _e(Oe,[e,t]).map(function(n){return{first:rn.constant(e),last:rn.constant(t),table:rn.constant(n)}})})})}function Ee(o,n,t){return Be(o,n,t).bind(function(e){function n(n){return Zn.eq(o,n)}var t=Jt.ancestor(e.first(),"thead,tfoot,tbody,table",n),r=Jt.ancestor(e.last(),"thead,tfoot,tbody,table",n);return t.bind(function(t){return r.bind(function(n){return Zn.eq(t,n)?function(n,t,e){var r=ke(n);return Se(r,t,e)}(e.table(),e.first(),e.last()):ln.none()})})})}function Me(u){if(!sn.isArray(u))throw new Error("cases must be an array");if(0===u.length)throw new Error("there must be at least one case");var a=[],e={};return hn.each(u,function(n,r){var t=bn.keys(n);if(1!==t.length)throw new Error("one and only one name per case");var o=t[0],i=n[o];if(void 0!==e[o])throw new Error("duplicate key detected:"+o);if("cata"===o)throw new Error("cannot have a case named cata (sorry)");if(!sn.isArray(i))throw new Error("case arguments must be an array");a.push(o),e[o]=function(){var n=arguments.length;if(n!==i.length)throw new Error("Wrong number of arguments to case "+o+". Expected "+i.length+" ("+i+"), got "+n);for(var e=new Array(n),t=0;t<e.length;t++)e[t]=arguments[t];return{fold:function(){if(arguments.length!==u.length)throw new Error("Wrong number of arguments to fold. Expected "+u.length+", got "+arguments.length);return arguments[r].apply(null,e)},match:function(n){var t=bn.keys(n);if(a.length!==t.length)throw new Error("Wrong number of arguments to match. Expected: "+a.join(",")+"\nActual: "+t.join(","));if(!hn.forall(a,function(n){return hn.contains(t,n)}))throw new Error("Not all branches were specified when using match. Specified: "+t.join(", ")+"\nRequired: "+a.join(", "));return n[o].apply(null,e)},log:function(n){console.log(n,{constructors:a,constructor:o,params:e})}}}}),e}function We(n,t){return Xe.cata(t.get(),rn.constant([]),rn.identity,rn.constant([n]))}function je(n){return{element:rn.constant(n),mergable:ln.none,unmergable:ln.none,selection:rn.constant([n])}}function qe(a,n,c,l){a.on("BeforeGetContent",function(t){!0===t.selection&&Xe.cata(n.get(),rn.noop,function(n){t.preventDefault(),Zt(n[0]).map(le).map(function(n){return[function(n,t){function e(n){return An.is(n.element(),t)}var r,i,o,u,a,c,l,s,f,d,m=yt(n),g=Qt(m),p=(i=e,o=(r=g).grid().columns(),u=r.grid().rows(),a=o,l=c=0,bn.each(r.access(),function(n){if(i(n)){var t=n.row(),e=t+n.rowspan()-1,r=n.column(),o=r+n.colspan()-1;t<u?u=t:c<e&&(c=e),r<a?a=r:l<o&&(l=o)}}),ce(u,a,c,l)),h="th:not("+t+"),td:not("+t+")",v=tt.filterFirstLayer(n,"th,td",function(n){return An.is(n,h)});return hn.each(v,ae.remove),function(n,t,e,r){for(var o,i,u,a=t.grid().columns(),c=t.grid().rows(),l=0;l<c;l++)for(var s=!1,f=0;f<a;f++)l<e.minRow()||l>e.maxRow()||f<e.minCol()||f>e.maxCol()||(ne(t,l,f).filter(r).isNone()?(o=s,i=n[l].element(),u=kn.fromTag("td"),ie.append(u,kn.fromTag("br")),(o?ie.append:ie.prepend)(i,u)):s=!0)}(m,g,p,e),s=n,f=p,d=hn.filter(tt.firstLayer(s,"tr"),function(n){return 0===n.dom().childElementCount}),hn.each(d,ae.remove),f.minCol()!==f.maxCol()&&f.minRow()!==f.maxRow()||hn.each(tt.firstLayer(s,"th,td"),function(n){ut.remove(n,"rowspan"),ut.remove(n,"colspan")}),ut.remove(s,"width"),ut.remove(s,"height"),oe.remove(s,"width"),oe.remove(s,"height"),n}(n,Ye.attributeSelector())]}).each(function(n){t.content=hn.map(n,function(n){return t=n,a.selection.serializer.serialize(t.dom(),{});var t}).join("")})},rn.noop)}),a.on("BeforeSetContent",function(u){!0===u.selection&&!0===u.paste&&ln.from(a.dom.getParent(a.selection.getStart(),"th,td")).each(function(n){var i=kn.fromDom(n);Zt(i).bind(function(t){var n=hn.filter(function(n,t){var e=(t||document).createElement("div");return e.innerHTML=n,Qn.children(kn.fromDom(e))}(u.content),function(n){return"meta"!==it.name(n)});if(1===n.length&&"table"===it.name(n[0])){u.preventDefault();var e=kn.fromDom(a.getDoc()),r=_t(e),o=$e.paste(i,n[0],r);c.pasteCells(t,o).each(function(n){a.selection.setRng(n),a.focus(),l.clear(t)})}})})})}var He=function(t,n,e){return n.bind(function(n){return e.filter(rn.curry(t.eq,n))})},Le=ye,ze=ve(),_e=function(e,n){return function(n,t,e){return be(n,t,e)}(ze,function(n,t){return e(t)},n)},Fe=function(n,t,e){return function(n,t,e,r){return Le(n,t,e,r)}(ze,n,t,e)},Ve=Re,Ue=wn.immutableBag(["boxes","start","finish"],[]),Ge=Ie,Ye={selected:rn.constant("data-mce-selected"),selectedSelector:rn.constant("td[data-mce-selected],th[data-mce-selected]"),attributeSelector:rn.constant("[data-mce-selected]"),firstSelected:rn.constant("data-mce-first-selected"),firstSelectedSelector:rn.constant("td[data-mce-first-selected],th[data-mce-first-selected]"),lastSelected:rn.constant("data-mce-last-selected"),lastSelectedSelector:rn.constant("td[data-mce-last-selected],th[data-mce-last-selected]")},Je=Me([{none:[]},{multiple:["elements"]},{single:["selection"]}]),Xe={cata:function(n,t,e,r){return n.fold(t,e,r)},none:Je.none,multiple:Je.multiple,single:Je.single},Ke=We,Ze=wn.immutable("element","clipboard","generators"),$e={noMenu:je,forMenu:function(n,t,e){return{element:rn.constant(e),mergable:rn.constant(function(e,n){return Xe.cata(n.get(),ln.none,function(t,n){return 0===t.length?ln.none():Ee(e,Ye.firstSelectedSelector(),Ye.lastSelectedSelector()).bind(function(n){return 1<t.length?ln.some({bounds:rn.constant(n),cells:rn.constant(t)}):ln.none()})},ln.none)}(t,n)),unmergable:rn.constant(function(n,t){var e=We(n,t);return 0<e.length&&hn.forall(e,function(n){return ut.has(n,"rowspan")&&1<parseInt(ut.get(n,"rowspan"),10)||ut.has(n,"colspan")&&1<parseInt(ut.get(n,"colspan"),10)})?ln.some(e):ln.none()}(e,n)),selection:rn.constant(Ke(e,n))}},notCell:function(n){return je(n)},paste:Ze,pasteRows:function(n,t,e,r,o){return{element:rn.constant(e),mergable:ln.none,unmergable:ln.none,selection:rn.constant(Ke(e,n)),clipboard:rn.constant(r),generators:rn.constant(o)}}};function Qe(r,o){function n(n){var t=o(n);if(t<=0||null===t){var e=oe.get(n,r);return parseFloat(e)||0}return t}function i(o,n){return hn.foldl(n,function(n,t){var e=oe.get(o,t),r=void 0===e?0:parseInt(e,10);return isNaN(r)?n:n+r},0)}return{set:function(n,t){if(!sn.isNumber(t)&&!t.match(/^[0-9]+$/))throw r+".set accepts only positive integer values. Value was "+t;var e=n.dom();Rt(e)&&(e.style[r]=t+"px")},get:n,getOuter:n,aggregate:i,max:function(n,t,e){var r=i(n,e);return r<t?t-r:0}}}function nr(n){return wr.get(n)}function tr(n){return wr.getOuter(n)}function er(n){return yr.get(n)}function rr(n){return yr.getOuter(n)}function or(n,t,e){return r=oe.get(n,t),o=e,i=parseFloat(r),isNaN(i)?o:i;var r,o,i}function ir(n,t){oe.set(n,"height",t+"px")}function ur(n){var t,e=oe.getRaw(t=n,"height").getOrThunk(function(){return function(n){return xr.browser.isIE()||xr.browser.isEdge()?(e=or(t=n,"padding-top",0),r=or(t,"padding-bottom",0),o=or(t,"border-top-width",0),i=or(t,"border-bottom-width",0),u=t.dom().getBoundingClientRect().height,"border-box"===oe.get(t,"box-sizing")?u:u-e-r-(o+i)):or(n,"height",nr(n));var t,e,r,o,i,u}(t)+"px"});return e?function(n,t,e,r){var o,i,u,a,c=parseInt(n,10);return _n(n,"%")&&"table"!==it.name(t)?(i=c,u=e,r(o=t,a=Zt(o).map(function(n){var t=u(n);return Math.floor(i/100*t)}).getOr(i)),a):c}(e,n,nr,ir):nr(n)}function ar(n){return oe.getRaw(n,"width").fold(function(){return ln.from(ut.get(n,"width"))},function(n){return ln.some(n)})}function cr(n,t){return n/t.pixelWidth()*100}function lr(e,r){Tr.getGenericWidth(e).each(function(n){var t=n.width()/2;Tr.setGenericWidth(e,t,n.unit()),Tr.setGenericWidth(r,t,n.unit())})}function sr(n,t){return void 0!==n?n:void 0!==t?t:0}function fr(n){var t,e=n.dom(),r=e.ownerDocument,o=r.body,i=kn.fromDom(r.documentElement);return o===e?Dr(o.offsetLeft,o.offsetTop):function(n,t){var e=t||kn.fromDom(document.documentElement);return Yt.ancestor(n,rn.curry(Zn.eq,e)).isSome()}(n,i)?(t=e.getBoundingClientRect(),Dr(t.left,t.top)):Dr(0,0)}function dr(n){var t=n.dom().ownerDocument,e=t.body,r=function(n){var t=n.dom();return t===t.window?n:it.isDocument(n)?t.defaultView||t.parentWindow:null}(kn.fromDom(t)),o=t.documentElement,i=sr(r.pageYOffset,o.scrollTop),u=sr(r.pageXOffset,o.scrollLeft),a=sr(o.clientTop,e.clientTop),c=sr(o.clientLeft,e.clientLeft);return fr(n).translate(u-c,i-a)}function mr(n){return dr(n).left()+rr(n)}function gr(n){return dr(n).left()}function pr(n,t){return Ar(n,gr(t))}function hr(n,t){return Ar(n,mr(t))}function vr(n){return dr(n).top()}function br(e,t,r){if(0===r.length)return[];var n=hn.map(r.slice(1),function(n,t){return n.map(function(n){return e(t,n)})}),o=r[r.length-1].map(function(n){return t(r.length-1,n)});return n.concat([o])}var wr=Qe("height",function(n){return lt.inBody(n)?n.dom().getBoundingClientRect().height:n.dom().offsetHeight}),yr=Qe("width",function(n){return n.dom().offsetWidth}),xr=Xn.detect(),Cr=/(\d+(\.\d+)?)(\w|%)*/,Rr=/(\d+(\.\d+)?)%/,Sr=/(\d+(\.\d+)?)px|em/,Tr={percentageBasedSizeRegex:rn.constant(Rr),pixelBasedSizeRegex:rn.constant(Sr),setPixelWidth:function(n,t){oe.set(n,"width",t+"px")},setPercentageWidth:function(n,t){oe.set(n,"width",t+"%")},setHeight:ir,getPixelWidth:function(t,e){return ar(t).fold(function(){var n=er(t);return parseInt(n,10)},function(n){return function(n,t,e){if(Sr.test(t)){var r=Sr.exec(t);return parseInt(r[1],10)}if(Rr.test(t)){var o=Rr.exec(t);return parseFloat(o[1])/100*e.pixelWidth()}var i=er(n);return parseInt(i,10)}(t,n,e)})},getPercentageWidth:function(e,r){return ar(e).fold(function(){var n=er(e),t=parseInt(n,10);return cr(t,r)},function(n){return function(n,t,e){if(Rr.test(t)){var r=Rr.exec(t);return parseFloat(r[1])}var o=er(n),i=parseInt(o,10);return cr(i,e)}(e,n,r)})},getGenericWidth:function(n){return ar(n).bind(function(n){if(Cr.test(n)){var t=Cr.exec(n);return ln.some({width:rn.constant(t[1]),unit:rn.constant(t[3])})}return ln.none()})},setGenericWidth:function(n,t,e){oe.set(n,"width",t+e)},getHeight:function(n){return"rowspan",ur(t=n)/function(n,t){return ut.has(n,t)?parseInt(ut.get(n,t),10):1}(t,"rowspan");var t},getRawWidth:ar},Dr=function(e,r){return{left:rn.constant(e),top:rn.constant(r),translate:function(n,t){return Dr(e+n,r+t)}}},kr=wn.immutable("row","y"),Ar=wn.immutable("col","x"),Nr={delta:rn.identity,positions:rn.curry(br,function(n,t){return kr(n,vr(t))},function(n,t){return kr(n,vr(t)+tr(t))}),edge:vr},Or={delta:rn.identity,edge:gr,positions:rn.curry(br,pr,hr)},Ir={height:Nr,rtl:{delta:function(n,t){return-n},edge:mr,positions:rn.curry(br,hr,pr)},ltr:Or},Pr={ltr:Ir.ltr,rtl:Ir.rtl};function Br(t){function e(n){return t(n).isRtl()?Pr.rtl:Pr.ltr}return{delta:function(n,t){return e(t).delta(n,t)},edge:function(n){return e(n).edge(n)},positions:function(n,t){return e(t).positions(n,t)}}}function Er(n){var t=yt(n);return Qt(t).grid()}function Mr(n,t){return Bi(n,t,{validate:sn.isFunction,label:"function"})}function Wr(n){var t=ut.has(n,"colspan")?parseInt(ut.get(n,"colspan"),10):1,e=ut.has(n,"rowspan")?parseInt(ut.get(n,"rowspan"),10):1;return{element:rn.constant(n),colspan:rn.constant(t),rowspan:rn.constant(e)}}function jr(e,n){function r(n){var t=function(n){var t;return t=i(n),e.cell(t)}(n);return o.get().isNone()&&o.set(ln.some(t)),u=ln.some({item:n,replacement:t}),t}Wi(e);var o=Pi(ln.none()),i=void 0!==n?n:Wr,u=ln.none();return{getOrInit:function(t,e){return u.fold(function(){return r(t)},function(n){return e(t,n.item)?n.replacement:r(t)})},cursor:o.get}}function qr(o,a){return function(e){var r=Pi(ln.none());Wi(e);function i(n){var t=e.replace(n,a,{scope:o});return u.push({item:n,sub:t}),r.get().isNone()&&r.set(ln.some(t)),t}var u=[];return{replaceOrInit:function(t,e){return(r=t,o=e,hn.find(u,function(n){return o(n.item,r)})).fold(function(){return i(t)},function(n){return e(t,n.item)?n.sub:i(t)});var r,o},cursor:r.get}}}function Hr(e){Wi(e);var n=Pi(ln.none());return{combine:function(t){return n.get().isNone()&&n.set(ln.some(t)),function(){var n=e.cell({element:rn.constant(t),colspan:rn.constant(1),rowspan:rn.constant(1)});return oe.remove(n,"width"),oe.remove(t,"width"),n}},cursor:n.get}}function Lr(n){return qi(Li,n)}function zr(n){return function(n,t){var e=n.property().name(t);return hn.contains(["ol","ul"],e)}(Li,n)}function _r(n){function i(n){return"br"===it.name(n)}function r(o){return pe(o).bind(function(e){var r=Qn.nextSibling(e).map(function(n){return!!Lr(n)||(function(n){return Hi(Li,n)}(n)?"img"!==it.name(n):void 0)}).getOr(!1);return Qn.parent(e).map(function(n){return!0===r||(t=n,"li"===it.name(t)||Yt.ancestor(t,zr).isSome())||i(e)||Lr(n)&&!Zn.eq(o,n)?[]:[kn.fromTag("br")];var t})}).getOr([])}var t,e=0===(t=hn.bind(n,function(n){var t,e=Qn.children(n);return t=e,hn.forall(t,function(n){return i(n)||it.isText(n)&&0===fe.get(n).trim().length})?[]:e.concat(r(n))})).length?[kn.fromTag("br")]:t;ae.empty(n[0]),ue.append(n[0],e)}function Fr(u){return function(){for(var n=new Array(arguments.length),t=0;t<n.length;t++)n[t]=arguments[t];if(0===n.length)throw new Error("Can't merge zero objects");for(var e={},r=0;r<n.length;r++){var o=n[r];for(var i in o)o.hasOwnProperty(i)&&(e[i]=u(e[i],o[i]))}return e}}function Vr(n){for(var t=[],e=function(n){t.push(n)},r=0;r<n.length;r++)n[r].each(e);return t}function Ur(n,t){for(var e=0;e<n.length;e++){var r=t(n[e],e);if(r.isSome())return r}return ln.none()}function Gr(n,t){return Dn.rowcells(t,n.section())}function Yr(n,t){return n.cells()[t]}function Jr(n,t){if(0===n.length)return 0;var e=n[0];return hn.findIndex(n,function(n){return!t(e.element(),n.element())}).fold(function(){return n.length},function(n){return n})}function Xr(o,i){var u=hn.map(o,function(n,t){return hn.map(n.cells(),function(n,t){return!1})});return hn.map(o,function(n,r){var t=hn.bind(n.cells(),function(n,t){if(!1!==u[r][t])return[];var e=function(n,t,e,r){var o,i,u=n[t].cells().slice(e),a=Jr(u,r),c=(o=n,i=e,hn.map(o,function(n){return Yi(n,i)})).slice(t),l=Jr(c,r);return{colspan:rn.constant(a),rowspan:rn.constant(l)}}(o,r,t,i);return function(n,t,e,r){for(var o=n;o<n+e;o++)for(var i=t;i<t+r;i++)u[o][i]=!0}(r,t,e.rowspan(),e.colspan()),[Dn.detailnew(n.element(),e.rowspan(),e.colspan(),n.isNew())]});return Dn.rowdetails(t,n.section())})}function Kr(n,t,e){for(var r=[],o=0;o<n.grid().rows();o++){for(var i=[],u=0;u<n.grid().columns();u++){var a=ne(n,o,u).map(function(n){return Dn.elementnew(n.element(),e)}).getOrThunk(function(){return Dn.elementnew(t.gap(),!0)});i.push(a)}var c=Dn.rowcells(i,n.all()[o].section());r.push(c)}return r}function Zr(n,t,e,r){e===r?ut.remove(n,t):ut.set(n,t,e)}function $r(n,t){for(var e=[],r=n;r<t;r++)e.push(r);return e}function Qr(t,e){if(e<0||e>=t.length-1)return ln.none();var n=t[e].fold(function(){var n=hn.reverse(t.slice(0,e));return Ur(n,function(n,t){return n.map(function(n){return{value:n,delta:t+1}})})},function(n){return ln.some({value:n,delta:0})}),r=t[e+1].fold(function(){var n=t.slice(e+1);return Ur(n,function(n,t){return n.map(function(n){return{value:n,delta:t+1}})})},function(n){return ln.some({value:n,delta:1})});return n.bind(function(e){return r.map(function(n){var t=n.delta+e.delta;return Math.abs(n.value-e.value)/t})})}function no(n,t,e){var r=n();return hn.find(r,t).orThunk(function(){return ln.from(r[0]).orThunk(e)}).map(function(n){return n.element()})}function to(e){var n=e.grid(),t=$r(0,n.columns()),r=$r(0,n.rows());return hn.map(t,function(t){return no(function(){return hn.bind(r,function(n){return ne(e,n,t).filter(function(n){return n.column()===t}).fold(rn.constant([]),function(n){return[n]})})},function(n){return 1===n.colspan()},function(){return ne(e,0,t)})})}function eo(e){var n=e.grid(),t=$r(0,n.rows()),r=$r(0,n.columns());return hn.map(t,function(t){return no(function(){return hn.bind(r,function(n){return ne(e,t,n).filter(function(n){return n.row()===t}).fold(rn.constant([]),function(n){return[n]})})},function(n){return 1===n.rowspan()},function(){return ne(e,t,0)})})}function ro(n){var t=n.replace(/\./g,"-");return{resolve:function(n){return t+"-"+n}}}function oo(n,t){var e=ut.get(n,t);return void 0===e||""===e?[]:e.split(" ")}function io(n,t){return function(n,t,e){var r=oo(n,t).concat([e]);ut.set(n,t,r.join(" "))}(n,"class",t)}function uo(n){return void 0!==n.dom().classList}function ao(n,t){return uo(n)&&n.dom().classList.contains(t)}function co(n){var t=dt.descendants(n.parent(),"."+tu);hn.each(t,ae.remove)}function lo(e,n,r){var o=e.origin();hn.each(n,function(n,t){n.each(function(n){var t=r(o,n);Qi(t,tu),ie.append(e.parent(),t)})})}function so(n,t,e,r,o,i){var u,a,c,l,s,f,d,m,g=dr(t);u=n,a=0<e.length?o.positions(e,t):[],c=g,l=rr(t),lo(u,a,function(n,t){var e=function(n,t,e,r,o){var i=kn.fromTag("div");return oe.setAll(i,{position:"absolute",left:t+"px",top:e-o/2+"px",height:o+"px",width:r+"px"}),ut.setAll(i,{"data-row":n,role:"presentation"}),i}(t.row(),c.left()-n.left(),t.y()-n.top(),l,7);return Qi(e,eu),e}),s=n,f=0<r.length?i.positions(r,t):[],d=g,m=tr(t),lo(s,f,function(n,t){var e=function(n,t,e,r,o){var i=kn.fromTag("div");return oe.setAll(i,{position:"absolute",left:t-r/2+"px",top:e+"px",height:o+"px",width:r+"px"}),ut.setAll(i,{"data-column":n,role:"presentation"}),i}(t.col(),t.x()-n.left(),d.top()-n.top(),7,m);return Qi(e,ru),e})}function fo(n,t){var e=dt.descendants(n.parent(),"."+tu);hn.each(e,t)}function mo(n,t){return function(n,r){return hn.map(n,function(n){var t,e=(t=n.details(),Ur(t,function(n){return Qn.parent(n.element()).map(function(n){var t=Qn.parent(n).isNone();return Dn.elementnew(n,t)})}).getOrThunk(function(){return Dn.elementnew(r.row(),!0)}));return Dn.rowdatanew(e.element(),n.details(),n.section(),e.isNew())})}(Xr(n,Zn.eq),t)}function go(n,t){var e=hn.flatten(hn.map(n.all(),function(n){return n.cells()}));return hn.find(e,function(n){return Zn.eq(t,n.element())})}function po(a,c,l,s,f){return function(e,r,n,o,i){var t=yt(r),u=Qt(t);return c(u,n).map(function(n){var t=Kr(u,o,!1),e=a(t,n,Zn.eq,f(o)),r=mo(e.grid(),o);return{grid:rn.constant(r),cursor:e.cursor}}).fold(function(){return ln.none()},function(n){var t=function(o,n){function t(n,t){0<n.length?function(n,t){var e=Jt.child(o,t).getOrThunk(function(){var n=kn.fromTag(t,Qn.owner(o).dom());return ie.append(o,n),n});ae.empty(e);var r=hn.map(n,function(n){n.isNew()&&i.push(n.element());var t=n.element();return ae.empty(t),hn.each(n.cells(),function(n){n.isNew()&&u.push(n.element()),Zr(n.element(),"colspan",n.colspan(),1),Zr(n.element(),"rowspan",n.rowspan(),1),ie.append(t,n.element())}),t});ue.append(e,r)}(n,t):Jt.child(o,t).bind(ae.remove)}var i=[],u=[],e=[],r=[],a=[];return hn.each(n,function(n){switch(n.section()){case"thead":e.push(n);break;case"tbody":r.push(n);break;case"tfoot":a.push(n)}}),t(e,"thead"),t(r,"tbody"),t(a,"tfoot"),{newRows:rn.constant(i),newCells:rn.constant(u)}}(r,n.grid());return l(r,n.grid(),i),s(r),ou(e,r,Ir.height,i),ln.some({cursor:n.cursor,newRows:t.newRows,newCells:t.newCells})})}}function ho(t,n){return Xt(n.element()).bind(function(n){return go(t,n)})}function vo(t,n){var e=hn.map(n.selection(),function(n){return Xt(n).bind(function(n){return go(t,n)})}),r=Vr(e);return 0<r.length?ln.some(r):ln.none()}function bo(t,n){var e=hn.map(n.selection(),function(n){return Xt(n).bind(function(n){return go(t,n)})}),r=Vr(e);return 0<r.length?ln.some(Fi.merge({cells:r},{generators:n.generators,clipboard:n.clipboard})):ln.none()}function wo(n,t){return hn.map(n,function(){return Dn.elementnew(t.cell(),!0)})}function yo(n,t,e){return hn.map(n,function(n){return Ui(n,n.cells().concat(wo($r(0,t),e)))})}function xo(n,t){var e=Ki(n[0]),r=Ki(t[0]);return{rowDelta:rn.constant(0),colDelta:rn.constant(e-r)}}function Co(n,t,e){var r=t.colDelta()<0?yo:rn.identity;return(t.rowDelta()<0?function(t,n,e){return t.concat(function(n,t){for(var e=[],r=0;r<n;r++)e.push(t(r));return e}(n,function(n){return Ui(t[t.length-1],wo(t[t.length-1].cells(),e))}))}:rn.identity)(r(n,Math.abs(t.colDelta()),e),Math.abs(t.rowDelta()),e)}function Ro(n,t,e,r){for(var o=!0,i=0;i<n.length;i++)for(var u=0;u<Ki(n[0]);u++){var a=e(Ji(n[i],u),t);!0===a&&!1===o?Gi(n[i],u,Dn.elementnew(r(),!0)):!0===a&&(o=!1)}return n}function So(e,r,o,i,u){return function(n,t,e){if(n.row()>=t.length||n.column()>Ki(t[0]))return mu.error("invalid start address out of table bounds, row: "+n.row()+", column: "+n.column());var r=t.slice(n.row()),o=r[0].cells().slice(n.column()),i=Ki(e[0]),u=e.length;return mu.value({rowDelta:rn.constant(r.length-u),colDelta:rn.constant(o.length-i)})}(e,r,o).map(function(n){var t=Co(r,n,i);return function(n,t,e,r,o){for(var i,u,a,c,l,s,f,d=n.row(),m=n.column(),g=d+e.length,p=m+Ki(e[0]),h=d;h<g;h++)for(var v=m;v<p;v++){a=v,c=o,s=l=void 0,l=Yi((i=t)[u=h],a),s=rn.curry(c,l.element()),f=i[u],1<i.length&&1<Ki(f)&&(0<a&&s(Ji(f,a-1))||a<f.length-1&&s(Ji(f,a+1))||0<u&&s(Ji(i[u-1],a))||u<i.length-1&&s(Ji(i[u+1],a)))&&Ro(t,Ji(t[h],v),o,r.cell);var b=Ji(e[h-d],v-m),w=r.replace(b);Gi(t[h],v,Dn.elementnew(w,!0))}return t}(e,t,o,i,u)})}function To(n,t,e,r,o){!function(i,u,a,c){if(0<u&&u<i.length){var n=(t=i[u-1].cells(),e=a,hn.foldl(t,function(n,t){return hn.exists(n,function(n){return e(n.element(),t.element())})?n:n.concat([t])},[]));hn.each(n,function(n){for(var t=ln.none(),e=u;e<i.length;e++)for(var r=0;r<Ki(i[0]);r++){var o=i[e].cells()[r];a(o.element(),n.element())&&(t.isNone()&&(t=ln.some(c())),t.each(function(n){Gi(i[e],r,Dn.elementnew(n,!0))}))}})}var t,e}(t,n,o,r.cell);var i=xo(e,t),u=Co(e,i,r),a=xo(t,u),c=Co(t,a,r);return c.slice(0,n).concat(u).concat(c.slice(n,c.length))}function Do(e,r,n,o,i){var t=e.slice(0,r),u=e.slice(r),a=Xi(e[n],function(n,t){return 0<r&&r<e.length&&o(Ji(e[r-1],t),Ji(e[r],t))?Yi(e[r],t):Dn.elementnew(i(n.element(),o),!0)});return t.concat([a]).concat(u)}function ko(n,e,r,o,i){return hn.map(n,function(n){var t=0<e&&e<Ki(n)&&o(Ji(n,e-1),Ji(n,e))?Yi(n,e):Dn.elementnew(i(Ji(n,r),o),!0);return Vi(n,e,t)})}function Ao(n,e,r,o){return hn.map(n,function(n){return Xi(n,function(n){return t=n,hn.exists(e,function(n){return r(t.element(),n.element())})?Dn.elementnew(o(n.element(),r),!0):n;var t})})}function No(n,t,e,r){return void 0!==Ji(n[t],e)&&0<t&&r(Ji(n[t-1],e),Ji(n[t],e))}function Oo(n,t,e){return 0<t&&e(Ji(n,t-1),Ji(n,t))}function Io(e,r,o,n){var t=hn.bind(e,function(n,t){return No(e,t,r,o)||Oo(n,r,o)?[]:[Yi(n,r)]});return Ao(e,t,o,n)}function Po(e,r,o,n){var i=e[r],t=hn.bind(i.cells(),function(n,t){return No(e,r,t,o)||Oo(i,t,o)?[]:[n]});return Ao(e,t,o,n)}function Bo(n){return{fold:n}}function Eo(){return Bo(function(n,t,e,r,o){return n()})}function Mo(n,t,i,u){function a(n){return hn.map(n,rn.constant(0))}function r(n,t){if(0<=i){var e=Math.max(u.minCellWidth(),c[t]-i);return a(c.slice(0,n)).concat([i,e-c[t]]).concat(a(c.slice(t+1)))}var r=Math.max(u.minCellWidth(),c[n]+i),o=c[n]-r;return a(c.slice(0,n)).concat([r-c[n],o]).concat(a(c.slice(t+1)))}var e,o,c=n.slice(0),l=(o=t,0===(e=n).length?Eo():1===e.length?function(i){return Bo(function(n,t,e,r,o){return t(i)})}(0):0===o?function(i,u){return Bo(function(n,t,e,r,o){return e(i,u)})}(0,1):o===e.length-1?function(i,u){return Bo(function(n,t,e,r,o){return o(i,u)})}(o-1,o):0<o&&o<e.length-1?function(i,u,a){return Bo(function(n,t,e,r,o){return r(i,u,a)})}(o-1,o,o+1):Eo()),s=rn.constant(a(c)),f=r;return l.fold(s,function(n){return u.singleColumnWidth(c[n],i)},f,function(n,t,e){return r(t,e)},function(n,t){if(0<=i)return a(c.slice(0,t)).concat([i]);var e=Math.max(u.minCellWidth(),c[t]+i);return a(c.slice(0,t)).concat([e-c[t]])})}function Wo(n,t){return ut.has(n,t)&&1<parseInt(ut.get(n,t),10)}function jo(n,t,e){return oe.getRaw(n,t).fold(function(){return e(n)+"px"},function(n){return n})}function qo(n){return jo(n,"width",Tr.getPixelWidth)}function Ho(n){return jo(n,"height",Tr.getHeight)}function Lo(n,t,e,r,o){var i=to(n),u=hn.map(i,function(n){return n.map(t.edge)});return hn.map(i,function(n,t){return n.filter(rn.not(gu.hasColspan)).fold(function(){var n=Qr(u,t);return r(n)},function(n){return e(n,o)})})}function zo(n){return n.map(function(n){return n+"px"}).getOr("")}function _o(n,t,e,r){var o=eo(n),i=hn.map(o,function(n){return n.map(t.edge)});return hn.map(o,function(n,t){return n.filter(rn.not(gu.hasRowspan)).fold(function(){var n=Qr(i,t);return r(n)},function(n){return e(n)})})}function Fo(n,t,e){for(var r=0,o=n;o<t;o++)r+=void 0!==e[o]?e[o]:0;return r}function Vo(n,e){var t=re(n);return hn.map(t,function(n){var t=Fo(n.column(),n.column()+n.colspan(),e);return{element:n.element,width:rn.constant(t),colspan:n.colspan}})}function Uo(n){var t=parseInt(n,10),e=rn.identity;return{width:rn.constant(t),pixelWidth:rn.constant(t),getWidths:pu.getPixelWidths,getCellDelta:e,singleColumnWidth:function(n,t){return[Math.max(gu.minWidth(),n+t)-n]},minCellWidth:gu.minWidth,setElementWidth:Tr.setPixelWidth,setTableWidth:function(n,t,e){var r=hn.foldr(t,function(n,t){return n+t},0);Tr.setPixelWidth(n,r)}}}function Go(t){return Tr.getRawWidth(t).fold(function(){var n=er(t);return Uo(n)},function(n){return function(n,t){if(Tr.percentageBasedSizeRegex().test(t))return r=Tr.percentageBasedSizeRegex().exec(t)[1],o=n,i=parseFloat(r),u=er(o),{width:rn.constant(i),pixelWidth:rn.constant(u),getWidths:pu.getPercentageWidths,getCellDelta:function(n){return n/u*100},singleColumnWidth:function(n,t){return[100-n]},minCellWidth:function(){return gu.minWidth()/u*100},setElementWidth:Tr.setPercentageWidth,setTableWidth:function(n,t,e){var r=i+e;Tr.setPercentageWidth(n,r)}};if(Tr.pixelBasedSizeRegex().test(t)){var e=Tr.pixelBasedSizeRegex().exec(t);return Uo(e[1])}var r,o,i,u,a=er(n);return Uo(a)}(t,n)})}function Yo(n){return Qt(n)}function Jo(n){var t=yt(n);return Yo(t)}function Xo(n,e,r,t){var o=Jo(n),i=pu.getPixelHeights(o,t),u=hn.map(i,function(n,t){return r===t?Math.max(e+n,gu.minHeight()):n}),a=function(n,e){var t=re(n);return hn.map(t,function(n){var t=Fo(n.row(),n.row()+n.rowspan(),e);return{element:n.element,height:rn.constant(t),rowspan:n.rowspan}})}(o,u),c=function(n,e){return hn.map(n.all(),function(n,t){return{element:n.element,height:rn.constant(e[t])}})}(o,u);hn.each(c,function(n){Tr.setHeight(n.element(),n.height())}),hn.each(a,function(n){Tr.setHeight(n.element(),n.height())});var l,s=(l=u,hn.foldr(l,function(n,t){return n+t},0));Tr.setHeight(n,s)}function Ko(n){0===Kt(n).length&&ae.remove(n)}function Zo(n,t,e){return vu(n,t,e).orThunk(function(){return vu(n,0,0)})}function $o(n,t,e){return hu(n,vu(n,t,e))}function Qo(n){return hn.foldl(n,function(n,t){return hn.exists(n,function(n){return n.row()===t.row()})?n:n.concat([t])},[]).sort(function(n,t){return n.row()-t.row()})}function ni(n){return hn.foldl(n,function(n,t){return hn.exists(n,function(n){return n.column()===t.column()})?n:n.concat([t])},[]).sort(function(n,t){return n.column()-t.column()})}function ti(n,t,e){var r=function(n,e){return hn.map(n,function(n){var t=hn.map(Kt(n),function(n){var t=ut.has(n,"rowspan")?parseInt(ut.get(n,"rowspan"),10):1,e=ut.has(n,"colspan")?parseInt(ut.get(n,"colspan"),10):1;return Dn.detail(n,t,e)});return Dn.rowdata(n,t,e.section())})}(n,e),o=Qt(r);return Kr(o,t,!0)}function ei(n,t,e){var r=Go(n),o=Yo(t),i=r.getWidths(o,e,r),u=Vo(o,i);hn.each(u,function(n){r.setElementWidth(n.element(),n.width())});var a=hn.foldr(i,function(n,t){return t+n},0);0<u.length&&r.setElementWidth(n,a)}function ri(n){return kn.fromDom(n.getBody())}function oi(n){return n.getBoundingClientRect().width}function ii(n){return n.getBoundingClientRect().height}function ui(t){return function(n){return Zn.eq(n,ri(t))}}function ai(n){return/^[0-9]+$/.test(n)&&(n+="px"),n}function ci(n){var t=dt.descendants(n,"td[data-mce-style],th[data-mce-style]");ut.remove(n,"data-mce-style"),hn.each(t,function(n){ut.remove(n,"data-mce-style")})}function li(n){return"rtl"===oe.get(n,"direction")?"rtl":"ltr"}function si(n){return n.getParam("table_cell_advtab",!0,"boolean")}function fi(n){return n.getParam("table_row_advtab",!0,"boolean")}function di(n){return n.getParam("table_advtab",!0,"boolean")}function mi(n){return n.getParam("table_style_by_css",!1,"boolean")}function gi(n){return n.getParam("table_cell_class_list",[],"array")}function pi(n){return n.getParam("table_row_class_list",[],"array")}function hi(n){return n.getParam("table_class_list",[],"array")}function vi(n){return!1===n.getParam("table_responsive_width")}function bi(n,t){return n.fire("newrow",{node:t})}function wi(n,t){return n.fire("newcell",{node:t})}function yi(n,t,e,r){n.fire("ObjectResizeStart",{target:t,width:e,height:r})}function xi(n,t,e,r){n.fire("ObjectResized",{target:t,width:e,height:r})}function Ci(n,t,e){var r=yt(n),o=Qt(r);return vo(o,t).map(function(n){var t=Kr(o,e,!1).slice(n[0].row(),n[n.length-1].row()+n[n.length-1].rowspan());return function(n){return hn.map(n,function(n){var e=Et(n.element());return hn.each(n.cells(),function(n){var t=le(n.element());Zr(t,"colspan",n.colspan(),1),Zr(t,"rowspan",n.rowspan(),1),ie.append(e,t)}),e})}(su(t,e))})}function Ri(n,t,e){e&&n.formatter.apply("align"+e,{},t)}function Si(t,e){Du.each("left center right".split(" "),function(n){t.formatter.remove("align"+n,{},e)})}function Ti(o,n,i){var t;return function(n,t){for(var e=0;e<t.length;e++){var r=o.getStyle(t[e],i);if(void 0===n&&(n=r),n!==r)return""}return n}(t,o.select("td,th",n))}function Di(n,t){var e=n.dom,r=t.control.rootControl,o=r.toJSON(),i=e.parseStyle(o.style);"style"===t.control.name()?(r.find("#borderStyle").value(i["border-style"]||"")[0].fire("select"),r.find("#borderColor").value(i["border-color"]||"")[0].fire("change"),r.find("#backgroundColor").value(i["background-color"]||"")[0].fire("change"),r.find("#width").value(i.width||"").fire("change"),r.find("#height").value(i.height||"").fire("change")):(i["border-style"]=o.borderStyle,i["border-color"]=o.borderColor,i["background-color"]=o.backgroundColor,i.width=o.width?ai(o.width):"",i.height=o.height?ai(o.height):""),r.find("#style").value(e.serializeStyle(e.parseStyle(e.serializeStyle(i))))}function ki(e){function n(){var n=e.getParam("color_picker_callback");if(n)return function(t){return n.call(e,function(n){t.control.value(n).fire("change")},t.control.value())}}return{title:"Advanced",type:"form",defaults:{onchange:rn.curry(Di,e)},items:[{label:"Style",name:"style",type:"textbox"},{type:"form",padding:0,formItemDefaults:{layout:"grid",alignH:["start","right"]},defaults:{size:7},items:[{label:"Border style",type:"listbox",name:"borderStyle",width:90,onselect:rn.curry(Di,e),values:[{text:"Select...",value:""},{text:"Solid",value:"solid"},{text:"Dotted",value:"dotted"},{text:"Dashed",value:"dashed"},{text:"Double",value:"double"},{text:"Groove",value:"groove"},{text:"Ridge",value:"ridge"},{text:"Inset",value:"inset"},{text:"Outset",value:"outset"},{text:"None",value:"none"},{text:"Hidden",value:"hidden"}]},{label:"Border color",type:"colorbox",name:"borderColor",onaction:n()},{label:"Background color",type:"colorbox",name:"backgroundColor",onaction:n()}]}]}}function Ai(n,r,t){var o=function(n,e){return e=e||[],Du.each(n,function(n){var t={text:n.text||n.title};n.menu?t.menu=o(n.menu):(t.value=n.value,r&&r(t)),e.push(t)}),e};return o(n,t||[])}function Ni(n,t){var e=n.parseStyle(n.getAttrib(t,"style")),r={};return e["border-style"]&&(r.borderStyle=e["border-style"]),e["border-color"]&&(r.borderColor=e["border-color"]),e["background-color"]&&(r.backgroundColor=e["background-color"]),r.style=n.serializeStyle(e),r}function Oi(r,o,n){var i,u=r.dom;function a(n,t,e){e&&u.setAttrib(n,t,e)}function c(n,t,e){e&&u.setStyle(n,t,e)}ku(r,n),i=n.control.rootControl.toJSON(),r.undoManager.transact(function(){Du.each(o,function(n){var t,e;a(n,"scope",i.scope),1===o.length?a(n,"style",i.style):(t=n,e=i.style,delete t.dataset.mceStyle,t.style.cssText+=";"+e),a(n,"class",i.class),c(n,"width",ai(i.width)),c(n,"height",ai(i.height)),i.type&&n.nodeName.toLowerCase()!==i.type&&(n=u.rename(n,i.type)),1===o.length&&(Si(r,n),function(t,e){Du.each("top middle bottom".split(" "),function(n){t.formatter.remove("valign"+n,{},e)})}(r,n)),i.align&&Ri(r,n,i.align),i.valign&&function(n,t,e){e&&n.formatter.apply("valign"+e,{},t)}(r,n,i.valign)}),r.focus()})}function Ii(t){var n,e,r,o=[];if(o=t.dom.select("td[data-mce-selected],th[data-mce-selected]"),n=t.dom.getParent(t.selection.getStart(),"td,th"),!o.length&&n&&o.push(n),n=n||o[0]){var i,u,a,c;e=1<o.length?{width:"",height:"",scope:"",class:"",align:"",valign:"",style:"",type:n.nodeName.toLowerCase()}:(u=n,a=(i=t).dom,c={width:a.getStyle(u,"width")||a.getAttrib(u,"width"),height:a.getStyle(u,"height")||a.getAttrib(u,"height"),scope:a.getAttrib(u,"scope"),class:a.getAttrib(u,"class"),type:u.nodeName.toLowerCase(),style:"",align:"",valign:""},Du.each("left center right".split(" "),function(n){i.formatter.matchNode(u,"align"+n)&&(c.align=n)}),Du.each("top middle bottom".split(" "),function(n){i.formatter.matchNode(u,"valign"+n)&&(c.valign=n)}),si(i)&&Du.extend(c,Ni(a,u)),c),0<gi(t).length&&(r={name:"class",type:"listbox",label:"Class",values:Ai(gi(t),function(n){n.value&&(n.textStyle=function(){return t.formatter.getCssText({block:"td",classes:[n.value]})})})});var l={type:"form",layout:"flex",direction:"column",labelGapCalc:"children",padding:0,items:[{type:"form",layout:"grid",columns:2,labelGapCalc:!1,padding:0,defaults:{type:"textbox",maxWidth:50},items:[{label:"Width",name:"width",onchange:rn.curry(ku,t)},{label:"Height",name:"height",onchange:rn.curry(ku,t)},{label:"Cell type",name:"type",type:"listbox",text:"None",minWidth:90,maxWidth:null,values:[{text:"Cell",value:"td"},{text:"Header cell",value:"th"}]},{label:"Scope",name:"scope",type:"listbox",text:"None",minWidth:90,maxWidth:null,values:[{text:"None",value:""},{text:"Row",value:"row"},{text:"Column",value:"col"},{text:"Row group",value:"rowgroup"},{text:"Column group",value:"colgroup"}]},{label:"H Align",name:"align",type:"listbox",text:"None",minWidth:90,maxWidth:null,values:[{text:"None",value:""},{text:"Left",value:"left"},{text:"Center",value:"center"},{text:"Right",value:"right"}]},{label:"V Align",name:"valign",type:"listbox",text:"None",minWidth:90,maxWidth:null,values:[{text:"None",value:""},{text:"Top",value:"top"},{text:"Middle",value:"middle"},{text:"Bottom",value:"bottom"}]}]},r]};si(t)?t.windowManager.open({title:"Cell properties",bodyType:"tabpanel",data:e,body:[{title:"General",type:"form",items:l},ki(t)],onsubmit:rn.curry(Oi,t,o)}):t.windowManager.open({title:"Cell properties",data:e,body:l,onsubmit:rn.curry(Oi,t,o)})}}var Pi=function(n){function t(){return e}var e=n;return{get:t,set:function(n){e=n},clone:function(){return Pi(t())}}},Bi=function(r,o,i){if(0===o.length)throw new Error("You must specify at least one required field.");return b("required",o),w(o),function(t){var e=bn.keys(t);hn.forall(o,function(n){return hn.contains(e,n)})||h(o,e),r(o,e);var n=hn.filter(o,function(n){return!i.validate(t[n],n)});return 0<n.length&&function(n,t){throw new Error("All values need to be of type: "+t+". Keys ("+p(n).join(", ")+") were not.")}(n,i.label),t}},Ei=rn.noop,Mi={exactly:rn.curry(Mr,function(t,n){var e=hn.filter(n,function(n){return!hn.contains(t,n)});0<e.length&&v(e)}),ensure:rn.curry(Mr,Ei),ensureWith:rn.curry(Bi,Ei)},Wi=Mi.exactly(["cell","row","replace","gap"]),ji=["body","p","div","article","aside","figcaption","figure","footer","header","nav","section","ol","ul","table","thead","tfoot","tbody","caption","tr","td","th","h1","h2","h3","h4","h5","h6","blockquote","pre","address"],qi=function(n,t){var e=n.property().name(t);return hn.contains(ji,e)},Hi=function(n,t){return hn.contains(["br","img","hr","input"],n.property().name(t))},Li=ve(),zi=Fr(function(n,t){return sn.isObject(n)&&sn.isObject(t)?zi(n,t):t}),_i=Fr(function(n,t){return t}),Fi={deepMerge:zi,merge:_i},Vi=function(n,t,e){var r=n.cells(),o=r.slice(0,t),i=r.slice(t),u=o.concat([e]).concat(i);return Gr(n,u)},Ui=Gr,Gi=function(n,t,e){n.cells()[t]=e},Yi=Yr,Ji=function(n,t){return Yr(n,t).element()},Xi=function(n,t){var e=n.cells(),r=hn.map(e,t);return Dn.rowcells(r,n.section())},Ki=function(n){return n.cells().length},Zi={resolve:ro("ephox-snooker").resolve},$i=io,Qi=function(n,t){uo(n)?n.dom().classList.add(t):$i(n,t)},nu=ao,tu=Zi.resolve("resizer-bar"),eu=Zi.resolve("resizer-rows"),ru=Zi.resolve("resizer-cols"),ou=function(n,t,e,r){co(n);var o=yt(t),i=Qt(o),u=eo(i),a=to(i);so(n,t,u,a,e,r)},iu=function(n){fo(n,function(n){oe.set(n,"display","none")})},uu=function(n){fo(n,function(n){oe.set(n,"display","block")})},au=co,cu=function(n){return nu(n,eu)},lu=function(n){return nu(n,ru)},su=mo,fu=function(e){return{is:function(n){return e===n},isValue:rn.always,isError:rn.never,getOr:rn.constant(e),getOrThunk:rn.constant(e),getOrDie:rn.constant(e),or:function(n){return fu(e)},orThunk:function(n){return fu(e)},fold:function(n,t){return t(e)},map:function(n){return fu(n(e))},each:function(n){n(e)},bind:function(n){return n(e)},exists:function(n){return n(e)},forall:function(n){return n(e)},toOption:function(){return ln.some(e)}}},du=function(e){return{is:rn.never,isValue:rn.never,isError:rn.always,getOr:rn.identity,getOrThunk:function(n){return n()},getOrDie:function(){return rn.die(String(e))()},or:function(n){return n},orThunk:function(n){return n()},fold:function(n,t){return n(e)},map:function(n){return du(e)},each:rn.noop,bind:function(n){return du(e)},exists:rn.never,forall:rn.always,toOption:ln.none}},mu={value:fu,error:du},gu={hasColspan:function(n){return Wo(n,"colspan")},hasRowspan:function(n){return Wo(n,"rowspan")},minWidth:rn.constant(10),minHeight:rn.constant(10),getInt:function(n,t){return parseInt(oe.get(n,t),10)}},pu={getRawWidths:function(n,t){return Lo(n,t,qo,zo)},getPixelWidths:function(n,t,e){return Lo(n,t,Tr.getPixelWidth,function(n){return n.getOrThunk(e.minCellWidth)},e)},getPercentageWidths:function(n,t,e){return Lo(n,t,Tr.getPercentageWidth,function(n){return n.fold(function(){return e.minCellWidth()},function(n){return n/e.pixelWidth()*100})},e)},getPixelHeights:function(n,t){return _o(n,t,Tr.getHeight,function(n){return n.getOrThunk(gu.minHeight)})},getRawHeights:function(n,t){return _o(n,t,Ho,zo)}},hu=wn.immutable("grid","cursor"),vu=function(n,t,e){return ln.from(n[t]).bind(function(n){return ln.from(n.cells()[e]).bind(function(n){return ln.from(n.element())})})},bu={insertRowBefore:po(function(n,t,e,r){var o=t.row(),i=t.row(),u=Do(n,i,o,e,r.getOrInit);return $o(u,i,t.column())},ho,rn.noop,rn.noop,jr),insertRowsBefore:po(function(n,t,e,r){var o=t[0].row(),i=t[0].row(),u=Qo(t),a=hn.foldl(u,function(n,t){return Do(n,i,o,e,r.getOrInit)},n);return $o(a,i,t[0].column())},vo,rn.noop,rn.noop,jr),insertRowAfter:po(function(n,t,e,r){var o=t.row(),i=t.row()+t.rowspan(),u=Do(n,i,o,e,r.getOrInit);return $o(u,i,t.column())},ho,rn.noop,rn.noop,jr),insertRowsAfter:po(function(n,t,e,r){var o=Qo(t),i=o[o.length-1].row(),u=o[o.length-1].row()+o[o.length-1].rowspan(),a=hn.foldl(o,function(n,t){return Do(n,u,i,e,r.getOrInit)},n);return $o(a,u,t[0].column())},vo,rn.noop,rn.noop,jr),insertColumnBefore:po(function(n,t,e,r){var o=t.column(),i=t.column(),u=ko(n,i,o,e,r.getOrInit);return $o(u,t.row(),i)},ho,ei,rn.noop,jr),insertColumnsBefore:po(function(n,t,e,r){var o=ni(t),i=o[0].column(),u=o[0].column(),a=hn.foldl(o,function(n,t){return ko(n,u,i,e,r.getOrInit)},n);return $o(a,t[0].row(),u)},vo,ei,rn.noop,jr),insertColumnAfter:po(function(n,t,e,r){var o=t.column(),i=t.column()+t.colspan(),u=ko(n,i,o,e,r.getOrInit);return $o(u,t.row(),i)},ho,ei,rn.noop,jr),insertColumnsAfter:po(function(n,t,e,r){var o=t[t.length-1].column(),i=t[t.length-1].column()+t[t.length-1].colspan(),u=ni(t),a=hn.foldl(u,function(n,t){return ko(n,i,o,e,r.getOrInit)},n);return $o(a,t[0].row(),i)},vo,ei,rn.noop,jr),splitCellIntoColumns:po(function(n,t,e,r){var o=function(n,r,o,i,u){var a=o+1;return hn.map(n,function(n,t){var e=t===r?Dn.elementnew(u(Ji(n,o),i),!0):Yi(n,o);return Vi(n,a,e)})}(n,t.row(),t.column(),e,r.getOrInit);return $o(o,t.row(),t.column())},ho,ei,rn.noop,jr),splitCellIntoRows:po(function(n,t,e,r){var o=function(n,t,e,r,o){var i=t+1,u=n.slice(0,i),a=n.slice(i),c=Xi(n[t],function(n,t){return t===e?Dn.elementnew(o(n.element(),r),!0):n});return u.concat([c]).concat(a)}(n,t.row(),t.column(),e,r.getOrInit);return $o(o,t.row(),t.column())},ho,rn.noop,rn.noop,jr),eraseColumns:po(function(n,t,e,r){var o=ni(t),i=function(n,e,r){var t=hn.map(n,function(n){var t=n.cells().slice(0,e).concat(n.cells().slice(r+1));return Dn.rowcells(t,n.section())});return hn.filter(t,function(n){return 0<n.cells().length})}(n,o[0].column(),o[o.length-1].column()),u=Zo(i,t[0].row(),t[0].column());return hu(i,u)},vo,ei,Ko,jr),eraseRows:po(function(n,t,e,r){var o=Qo(t),i=function(n,t,e){return n.slice(0,t).concat(n.slice(e+1))}(n,o[0].row(),o[o.length-1].row()),u=Zo(i,t[0].row(),t[0].column());return hu(i,u)},vo,rn.noop,Ko,jr),makeColumnHeader:po(function(n,t,e,r){var o=Io(n,t.column(),e,r.replaceOrInit);return $o(o,t.row(),t.column())},ho,rn.noop,rn.noop,qr("row","th")),unmakeColumnHeader:po(function(n,t,e,r){var o=Io(n,t.column(),e,r.replaceOrInit);return $o(o,t.row(),t.column())},ho,rn.noop,rn.noop,qr(null,"td")),makeRowHeader:po(function(n,t,e,r){var o=Po(n,t.row(),e,r.replaceOrInit);return $o(o,t.row(),t.column())},ho,rn.noop,rn.noop,qr("col","th")),unmakeRowHeader:po(function(n,t,e,r){var o=Po(n,t.row(),e,r.replaceOrInit);return $o(o,t.row(),t.column())},ho,rn.noop,rn.noop,qr(null,"td")),mergeCells:po(function(n,t,e,r){var o=t.cells();_r(o);var i=function(n,t,e,r){if(0===n.length)return n;for(var o=t.startRow();o<=t.finishRow();o++)for(var i=t.startCol();i<=t.finishCol();i++)Gi(n[o],i,Dn.elementnew(r(),!1));return n}(n,t.bounds(),0,rn.constant(o[0]));return hu(i,ln.from(o[0]))},function(n,t){return t.mergable()},rn.noop,rn.noop,Hr),unmergeCells:po(function(n,t,e,r){var o=hn.foldr(t,function(n,t){return Ro(n,t,e,r.combine(t))},n);return hu(o,ln.from(t[0]))},function(n,t){return t.unmergable()},ei,rn.noop,Hr),pasteCells:po(function(n,e,t,r){var o,i,u,a,c=(o=e.clipboard(),i=e.generators(),u=yt(o),a=Qt(u),Kr(a,i,!0)),l=Dn.address(e.row(),e.column());return So(l,n,c,e.generators(),t).fold(function(){return hu(n,ln.some(e.element()))},function(n){var t=Zo(n,e.row(),e.column());return hu(n,t)})},function(t,e){return Xt(e.element()).bind(function(n){return go(t,n).map(function(n){return Fi.merge(n,{generators:e.generators,clipboard:e.clipboard})})})},ei,rn.noop,jr),pasteRowsBefore:po(function(n,t,e,r){var o=n[t.cells[0].row()],i=t.cells[0].row(),u=ti(t.clipboard(),t.generators(),o),a=To(i,n,u,t.generators(),e),c=Zo(a,t.cells[0].row(),t.cells[0].column());return hu(a,c)},bo,rn.noop,rn.noop,jr),pasteRowsAfter:po(function(n,t,e,r){var o=n[t.cells[0].row()],i=t.cells[t.cells.length-1].row()+t.cells[t.cells.length-1].rowspan(),u=ti(t.clipboard(),t.generators(),o),a=To(i,n,u,t.generators(),e),c=Zo(a,t.cells[0].row(),t.cells[0].column());return hu(a,c)},bo,rn.noop,rn.noop,jr)},wu=li,yu={isRtl:rn.constant(!1)},xu={isRtl:rn.constant(!0)},Cu=function(n){return"rtl"===wu(n)?xu:yu},Ru=["tableprops","tabledelete","|","tableinsertrowbefore","tableinsertrowafter","tabledeleterow","|","tableinsertcolbefore","tableinsertcolafter","tabledeletecol"],Su={"border-collapse":"collapse",width:"100%"},Tu={border:"1"},Du=tinymce.util.Tools.resolve("tinymce.util.Tools"),ku=Di;function Au(l,n,s,t){var f=l.dom;function d(n,t,e){e&&f.setAttrib(n,t,e)}ku(l,t);var m=t.control.rootControl.toJSON();l.undoManager.transact(function(){Du.each(n,function(n){var t,e,r,o,i,u,a,c;d(n,"scope",m.scope),d(n,"style",m.style),d(n,"class",m.class),t=n,(e=ai(m.height))&&f.setStyle(t,"height",e),m.type!==n.parentNode.nodeName.toLowerCase()&&(r=l.dom,o=n,i=m.type,u=r.getParent(o,"table"),a=o.parentNode,(c=r.select(i,u)[0])||(c=r.create(i),u.firstChild?"CAPTION"===u.firstChild.nodeName?r.insertAfter(c,u.firstChild):u.insertBefore(c,u.firstChild):u.appendChild(c)),c.appendChild(o),a.hasChildNodes()||r.remove(a)),m.align!==s.align&&(Si(l,n),Ri(l,n,m.align))}),l.focus()})}function Nu(t){var n,e,r,o,i,u,a,c,l,s,f=t.dom,d=[];n=f.getParent(t.selection.getStart(),"table"),e=f.getParent(t.selection.getStart(),"td,th"),Du.each(n.rows,function(t){Du.each(t.cells,function(n){if(f.getAttrib(n,"data-mce-selected")||n===e)return d.push(t),!1})}),(r=d[0])&&(i=1<d.length?{height:"",scope:"",style:"",class:"",align:"",type:r.parentNode.nodeName.toLowerCase()}:(c=r,l=(a=t).dom,s={height:l.getStyle(c,"height")||l.getAttrib(c,"height"),scope:l.getAttrib(c,"scope"),class:l.getAttrib(c,"class"),align:"",style:"",type:c.parentNode.nodeName.toLowerCase()},Du.each("left center right".split(" "),function(n){a.formatter.matchNode(c,"align"+n)&&(s.align=n)}),fi(a)&&Du.extend(s,Ni(l,c)),s),0<pi(t).length&&(o={name:"class",type:"listbox",label:"Class",values:Ai(pi(t),function(n){n.value&&(n.textStyle=function(){return t.formatter.getCssText({block:"tr",classes:[n.value]})})})}),u={type:"form",columns:2,padding:0,defaults:{type:"textbox"},items:[{type:"listbox",name:"type",label:"Row type",text:"Header",maxWidth:null,values:[{text:"Header",value:"thead"},{text:"Body",value:"tbody"},{text:"Footer",value:"tfoot"}]},{type:"listbox",name:"align",label:"Alignment",text:"None",maxWidth:null,values:[{text:"None",value:""},{text:"Left",value:"left"},{text:"Center",value:"center"},{text:"Right",value:"right"}]},{label:"Height",name:"height"},o]},fi(t)?t.windowManager.open({title:"Row properties",data:i,bodyType:"tabpanel",body:[{title:"General",type:"form",items:u},ki(t)],onsubmit:rn.curry(Au,t,d,i)}):t.windowManager.open({title:"Row properties",data:i,body:u,onsubmit:rn.curry(Au,t,d,i)}))}function Ou(n,t){n.selection.select(t.dom(),!0),n.selection.collapse(!0)}function Iu(o,n,t){var e,r,i=o.getParam("table_default_styles",Su,"object"),u=function(n,t,e,r,o){void 0===o&&(o=Bu);var i=kn.fromTag("table");oe.setAll(i,o.styles),ut.setAll(i,o.attributes);var u=kn.fromTag("tbody");ie.append(i,u);for(var a=[],c=0;c<n;c++){for(var l=kn.fromTag("tr"),s=0;s<t;s++){var f=kn.fromTag(c<e||s<r?"th":"td");s<r&&ut.set(f,"scope","row"),c<e&&ut.set(f,"scope","col"),ie.append(f,kn.fromTag("br")),o.percentages&&oe.set(f,"width",100/t+"%"),ie.append(l,f)}a.push(l)}return ue.append(u,a),i}(t,n,0,0,{styles:i,attributes:(r=o,r.getParam("table_default_attributes",Tu,"object")),percentages:(e=i.width,sn.isString(e)&&-1!==e.indexOf("%")&&!vi(o))});ut.set(u,"data-mce-id","__mce");var a=function(n){var t=kn.fromTag("div"),e=kn.fromDom(n.dom().cloneNode(!0));return ie.append(t,e),function(n){return n.dom().innerHTML}(t)}(u);return o.insertContent(a),Jt.descendant(ri(o),'table[data-mce-id="__mce"]').map(function(n){var t,e,r;return vi(o)&&oe.set(n,"width",oe.get(n,"width")),ut.remove(n,"data-mce-id"),t=o,e=n,hn.each(dt.descendants(e,"tr"),function(n){bi(t,n.dom()),hn.each(dt.descendants(n,"th,td"),function(n){wi(t,n.dom())})}),r=o,Jt.descendant(n,"td,th").each(rn.curry(Ou,r)),n.dom()}).getOr(null)}var Pu=tinymce.util.Tools.resolve("tinymce.Env"),Bu={styles:{"border-collapse":"collapse",width:"100%"},attributes:{border:"1"},percentages:!0};function Eu(n,t,e,r){if("TD"===t.tagName||"TH"===t.tagName)n.setStyle(t,e,r);else if(t.children)for(var o=0;o<t.children.length;o++)Eu(n,t.children[o],e,r)}function Mu(n,t,e){var r,o,i=n.dom;ku(n,e),!1===(o=e.control.rootControl.toJSON()).class&&delete o.class,n.undoManager.transact(function(){t=t||Iu(n,o.cols||1,o.rows||1),function(n,t,e){var r,o=n.dom,i={},u={};if(i.class=e.class,u.height=ai(e.height),o.getAttrib(t,"width")&&!mi(n)?i.width=(r=e.width)?r.replace(/px$/,""):"":u.width=ai(e.width),mi(n)?(u["border-width"]=ai(e.border),u["border-spacing"]=ai(e.cellspacing),Du.extend(i,{"data-mce-border-color":e.borderColor,"data-mce-cell-padding":e.cellpadding,"data-mce-border":e.border})):Du.extend(i,{border:e.border,cellpadding:e.cellpadding,cellspacing:e.cellspacing}),mi(n)&&t.children)for(var a=0;a<t.children.length;a++)Eu(o,t.children[a],{"border-width":ai(e.border),"border-color":e.borderColor,padding:ai(e.cellpadding)});e.style?Du.extend(u,o.parseStyle(e.style)):u=Du.extend({},o.parseStyle(o.getAttrib(t,"style")),u),i.style=o.serializeStyle(u),o.setAttribs(t,i)}(n,t,o),(r=i.select("caption",t)[0])&&!o.caption&&i.remove(r),!r&&o.caption&&((r=i.create("caption")).innerHTML=Pu.ie?"Â ":'<br data-mce-bogus="1"/>',t.insertBefore(r,t.firstChild)),Si(n,t),o.align&&Ri(n,t,o.align),n.focus(),n.addVisual()})}function Wu(t,n){var e,r,o,i,u,a,c,l,s,f,d=t.dom,m={};!0===n?(e=d.getParent(t.selection.getStart(),"table"))&&(c=e,l=(a=t).dom,s={width:l.getStyle(c,"width")||l.getAttrib(c,"width"),height:l.getStyle(c,"height")||l.getAttrib(c,"height"),cellspacing:l.getStyle(c,"border-spacing")||l.getAttrib(c,"cellspacing"),cellpadding:l.getAttrib(c,"data-mce-cell-padding")||l.getAttrib(c,"cellpadding")||Ti(a.dom,c,"padding"),border:l.getAttrib(c,"data-mce-border")||l.getAttrib(c,"border")||Ti(a.dom,c,"border"),borderColor:l.getAttrib(c,"data-mce-border-color"),caption:!!l.select("caption",c)[0],class:l.getAttrib(c,"class")},Du.each("left center right".split(" "),function(n){a.formatter.matchNode(c,"align"+n)&&(s.align=n)}),di(a)&&Du.extend(s,Ni(l,c)),m=s):(r={label:"Cols",name:"cols"},o={label:"Rows",name:"rows"}),0<hi(t).length&&(m.class&&(m.class=m.class.replace(/\s*mce\-item\-table\s*/g,"")),i={name:"class",type:"listbox",label:"Class",values:Ai(hi(t),function(n){n.value&&(n.textStyle=function(){return t.formatter.getCssText({block:"table",classes:[n.value]})})})}),u={type:"form",layout:"flex",direction:"column",labelGapCalc:"children",padding:0,items:[{type:"form",labelGapCalc:!1,padding:0,layout:"grid",columns:2,defaults:{type:"textbox",maxWidth:50},items:(f=t,f.getParam("table_appearance_options",!0,"boolean")?[r,o,{label:"Width",name:"width",onchange:rn.curry(ku,t)},{label:"Height",name:"height",onchange:rn.curry(ku,t)},{label:"Cell spacing",name:"cellspacing"},{label:"Cell padding",name:"cellpadding"},{label:"Border",name:"border"},{label:"Caption",name:"caption",type:"checkbox"}]:[r,o,{label:"Width",name:"width",onchange:rn.curry(ku,t)},{label:"Height",name:"height",onchange:rn.curry(ku,t)}])},{label:"Alignment",name:"align",type:"listbox",text:"None",values:[{text:"None",value:""},{text:"Left",value:"left"},{text:"Center",value:"center"},{text:"Right",value:"right"}]},i]},di(t)?t.windowManager.open({title:"Table properties",data:m,bodyType:"tabpanel",body:[{title:"General",type:"form",items:u},ki(t)],onsubmit:rn.curry(Mu,t,e)}):t.windowManager.open({title:"Table properties",data:m,body:u,onsubmit:rn.curry(Mu,t,e)})}function ju(n){var t=ln.from(n.dom().documentElement).map(kn.fromDom).getOr(n);return{parent:rn.constant(t),view:rn.constant(n),origin:rn.constant(Dr(0,0))}}var qu=Du.each;function Hu(n){var e=wn.immutable.apply(null,n),r=[];return{bind:function(n){if(void 0===n)throw"Event bind error: undefined handler";r.push(n)},unbind:function(t){r=hn.filter(r,function(n){return n!==t})},trigger:function(){var t=e.apply(null,arguments);hn.each(r,function(n){n(t)})}}}function Lu(n,t,e,r,o){var i=function(m,g){return function(n){if(m(n)){var t,e,r,o,i,u,a,c=kn.fromDom(n.target),l=function(){n.stopPropagation()},s=function(){n.preventDefault()},f=rn.compose(s,l),d=(t=c,e=n.clientX,r=n.clientY,o=l,i=s,u=f,a=n,{target:rn.constant(t),x:rn.constant(e),y:rn.constant(r),stop:o,prevent:i,kill:u,raw:rn.constant(a)});g(d)}}}(e,r);return n.dom().addEventListener(t,i,o),{unbind:rn.curry(Vu,n,t,i,o)}}var zu={create:function(n){return{registry:bn.map(n,function(n){return{bind:n.bind,unbind:n.unbind}}),trigger:bn.map(n,function(n){return n.trigger})}}},_u={mode:Mi.exactly(["compare","extract","mutate","sink"]),sink:Mi.exactly(["element","start","stop","destroy"]),api:Mi.exactly(["forceDrop","drop","move","delayDrop"])},Fu={resolve:ro("ephox-dragster").resolve},Vu=function(n,t,e,r){n.dom().removeEventListener(t,e,r)},Uu=rn.constant(!0),Gu=function(n,t,e){return function(n,t,e,r){return Lu(n,t,e,r,!1)}(n,t,Uu,e)},Yu=_u.mode({compare:function(n,t){return Dr(t.left()-n.left(),t.top()-n.top())},extract:function(n){return ln.some(Dr(n.x(),n.y()))},sink:function(n,t){var e,r,o,i=(e=t,r=Fi.merge({layerClass:Fu.resolve("blocker")},e),o=kn.fromTag("div"),ut.set(o,"role","presentation"),oe.setAll(o,{position:"fixed",left:"0px",top:"0px",width:"100%",height:"100%"}),Qi(o,Fu.resolve("blocker")),Qi(o,r.layerClass),{element:function(){return o},destroy:function(){ae.remove(o)}}),u=Gu(i.element(),"mousedown",n.forceDrop),a=Gu(i.element(),"mouseup",n.drop),c=Gu(i.element(),"mousemove",n.move),l=Gu(i.element(),"mouseout",n.delayDrop);return _u.sink({element:i.element,start:function(n){ie.append(n,i.element())},stop:function(){ae.remove(i.element())},destroy:function(){i.destroy(),a.unbind(),c.unbind(),l.unbind(),u.unbind()}})},mutate:function(n,t){n.mutate(t.left(),t.top())}});function Ju(){var n={onEvent:function(n,t){},reset:rn.noop},t=function(){var i=ln.none(),u=zu.create({move:Hu(["info"])});return{onEvent:function(n,o){o.extract(n).each(function(n){var t,e,r;(t=o,e=n,r=i.map(function(n){return t.compare(n,e)}),i=ln.some(e),r).each(function(n){u.trigger.move(n)})})},reset:function(){i=ln.none()},events:u.registry}}(),e=n;return{on:function(){e.reset(),e=t},off:function(){e.reset(),e=n},isOn:function(){return e===t},onEvent:function(n,t){e.onEvent(n,t)},events:t.events}}function Xu(t,e,n){function r(){l.stop(),u.isOn()&&(u.off(),i.trigger.stop())}var o=!1,i=zu.create({start:Hu([]),stop:Hu([])}),u=Ju(),a=function(t,e){var r=null;return{cancel:function(){null!==r&&(clearTimeout(r),r=null)},throttle:function(){var n=arguments;null!==r&&clearTimeout(r),r=setTimeout(function(){t.apply(null,n),n=r=null},e)}}}(r,200);function c(t){return function(){var n=Array.prototype.slice.call(arguments,0);if(o)return t.apply(null,n)}}u.events.move.bind(function(n){e.mutate(t,n.info())});var l=e.sink(_u.api({forceDrop:r,drop:c(r),move:c(function(n,t){a.cancel(),u.onEvent(n,e)}),delayDrop:c(a.throttle)}),n);return{element:l.element,go:function(n){l.start(n),u.on(),i.trigger.start()},on:function(){o=!0},off:function(){o=!1},destroy:function(){l.destroy()},events:i.registry}}var Ku=function(n,t){var e=void 0!==t?t:{},r=void 0!==e.mode?e.mode:Yu;return Xu(n,r,t)};var Zu=function(n,t,e){return Jt.closest(n,t,e).isSome()},$u=Zi.resolve("resizer-bar-dragging");function Qu(n,e){var r=Ir.height,t=function(o,t,i){function n(n,t){return ln.from(ut.get(n,t))}var e=function(){var e,r=zu.create({drag:Hu(["xDelta","yDelta","target"])}),o=ln.none(),n={mutate:function(n,t){e.trigger.drag(n,t)},events:(e=zu.create({drag:Hu(["xDelta","yDelta"])})).registry};return n.events.drag.bind(function(t){o.each(function(n){r.trigger.drag(t.xDelta(),t.yDelta(),n)})}),{assign:function(n){o=ln.some(n)},get:function(){return o},mutate:n.mutate,events:r.registry}}(),r=Ku(e,{}),u=ln.none();e.events.drag.bind(function(e){n(e.target(),"data-row").each(function(n){var t=gu.getInt(e.target(),"top");oe.set(e.target(),"top",t+e.yDelta()+"px")}),n(e.target(),"data-column").each(function(n){var t=gu.getInt(e.target(),"left");oe.set(e.target(),"left",t+e.xDelta()+"px")})});function a(n,t){return gu.getInt(n,t)-parseInt(ut.get(n,"data-initial-"+t),10)}r.events.stop.bind(function(){e.get().each(function(r){u.each(function(e){n(r,"data-row").each(function(n){var t=a(r,"top");ut.remove(r,"data-initial-top"),d.trigger.adjustHeight(e,t,parseInt(n,10))}),n(r,"data-column").each(function(n){var t=a(r,"left");ut.remove(r,"data-initial-left"),d.trigger.adjustWidth(e,t,parseInt(n,10))}),ou(o,e,i,t)})})});function c(n,t){d.trigger.startAdjust(),e.assign(n),ut.set(n,"data-initial-"+t,parseInt(oe.get(n,t),10)),Qi(n,$u),oe.set(n,"opacity","0.2"),r.go(o.parent())}function l(n){return Zn.eq(n,o.view())}var s=Gu(o.parent(),"mousedown",function(n){cu(n.target())&&c(n.target(),"top"),lu(n.target())&&c(n.target(),"left")}),f=Gu(o.view(),"mouseover",function(n){"table"===it.name(n.target())||Zu(n.target(),"table",l)?(u="table"===it.name(n.target())?ln.some(n.target()):Jt.ancestor(n.target(),"table",l)).each(function(n){ou(o,n,i,t)}):lt.inBody(n.target())&&au(o)}),d=zu.create({adjustHeight:Hu(["table","delta","row"]),adjustWidth:Hu(["table","delta","column"]),startAdjust:Hu([])});return{destroy:function(){s.unbind(),f.unbind(),r.destroy(),au(o)},refresh:function(n){ou(o,n,i,t)},on:r.on,off:r.off,hideBars:rn.curry(iu,o),showBars:rn.curry(uu,o),events:d.registry}}(n,e,r),o=zu.create({beforeResize:Hu(["table"]),afterResize:Hu(["table"]),startDrag:Hu([])});return t.events.adjustHeight.bind(function(n){o.trigger.beforeResize(n.table());var t=r.delta(n.delta(),n.table());Xo(n.table(),t,n.row(),r),o.trigger.afterResize(n.table())}),t.events.startAdjust.bind(function(n){o.trigger.startDrag()}),t.events.adjustWidth.bind(function(n){o.trigger.beforeResize(n.table());var t=e.delta(n.delta(),n.table());(function(n,t,e,r){var o=Go(n),i=o.getCellDelta(t),u=Jo(n),a=o.getWidths(u,r,o),c=Mo(a,e,i,o),l=hn.map(c,function(n,t){return n+a[t]}),s=Vo(u,l);hn.each(s,function(n){o.setElementWidth(n.element(),n.width())}),e===u.grid().columns()-1&&o.setTableWidth(n,l,i)})(n.table(),t,n.column(),e),o.trigger.afterResize(n.table())}),{on:t.on,off:t.off,hideBars:t.hideBars,showBars:t.showBars,destroy:t.destroy,events:o.registry}}function na(n,t){return n.inline?function(n,t){return{parent:rn.constant(t),view:rn.constant(n),origin:rn.constant(Dr(0,0))}}(ri(n),(e=kn.fromTag("div"),oe.setAll(e,{position:"static",height:"0",width:"0",padding:"0",margin:"0",border:"0"}),ie.append(lt.body(),e),e)):ju(kn.fromDom(n.getDoc()));var e}function ta(u){function a(n){return"TABLE"===n.nodeName}var c,l,o=ln.none(),i=ln.none(),s=ln.none(),f=/(\d+(\.\d+)?)%/;return u.on("init",function(){var n,t=Br(Cu),e=na(u);if(s=ln.some(e),("table"===(n=u.getParam("object_resizing",!0))||n)&&u.getParam("table_resize_bars",!0,"boolean")){var r=Qu(e,t);r.on(),r.events.startDrag.bind(function(n){o=ln.some(u.selection.getRng())}),r.events.beforeResize.bind(function(n){var t=n.table().dom();yi(u,t,oi(t),ii(t))}),r.events.afterResize.bind(function(n){var t=n.table(),e=t.dom();ci(t),o.each(function(n){u.selection.setRng(n),u.focus()}),xi(u,e,oi(e),ii(e)),u.undoManager.add()}),i=ln.some(r)}}),u.on("ObjectResizeStart",function(n){var t,e=n.target;a(e)&&(c=n.width,t=e,l=u.dom.getStyle(t,"width")||u.dom.getAttrib(t,"width"))}),u.on("ObjectResized",function(n){var t=n.target;if(a(t)){var e=t;if(f.test(l)){var r=parseFloat(f.exec(l)[1]),o=n.width*r/c;u.dom.setStyle(e,"width",o+"%")}else{var i=[];Du.each(e.rows,function(n){Du.each(n.cells,function(n){var t=u.dom.getStyle(n,"width",!0);i.push({cell:n,width:t})})}),Du.each(i,function(n){u.dom.setStyle(n.cell,"width",n.width),u.dom.setAttrib(n.cell,"width",null)})}}}),{lazyResize:function(){return i},lazyWire:function(){return s.getOr(ju(kn.fromDom(u.getBody())))},destroy:function(){i.each(function(n){n.destroy()}),s.each(function(n){!function(n,t){n.inline&&ae.remove(t.parent())}(u,n)})}}}function ea(n){return{fold:n}}function ra(o){return ea(function(n,t,e,r){return n(o)})}function oa(o,i){return ea(function(n,t,e,r){return e(o,i)})}function ia(e,n){return Zt(e,n).bind(function(n){var t=Kt(n);return hn.findIndex(t,function(n){return Zn.eq(e,n)}).map(function(n){return{index:rn.constant(n),all:rn.constant(t)}})})}function ua(t,n){return ia(t,n).fold(function(){return ra(t)},function(n){return n.index()+1<n.all().length?oa(t,n.all()[n.index()+1]):function(o){return ea(function(n,t,e,r){return r(o)})}(t)})}function aa(t,n){return ia(t,n).fold(function(){return ra()},function(n){return 0<=n.index()-1?oa(t,n.all()[n.index()-1]):function(o){return ea(function(n,t,e,r){return t(o)})}(t)})}function ca(n,t,e,r){var o=function(n,t,e,r){var o=Qn.owner(n).dom().createRange();return o.setStart(n.dom(),t),o.setEnd(e.dom(),r),o}(n,t,e,r),i=Zn.eq(n,e)&&t===r;return o.collapsed&&!i}function la(n,t){n.selectNodeContents(t.dom())}function sa(n){return{left:rn.constant(n.left),top:rn.constant(n.top),right:rn.constant(n.right),bottom:rn.constant(n.bottom),width:rn.constant(n.width),height:rn.constant(n.height)}}function fa(n,t,e){return t(kn.fromDom(e.startContainer),e.startOffset,kn.fromDom(e.endContainer),e.endOffset)}function da(n,t){var o,e,r,i=(o=n,t.match({domRange:function(n){return{ltr:rn.constant(n),rtl:ln.none}},relative:function(n,t){return{ltr:T(function(){return qa(o,n,t)}),rtl:T(function(){return ln.some(qa(o,t,n))})}},exact:function(n,t,e,r){return{ltr:T(function(){return Ha(o,n,t,e,r)}),rtl:T(function(){return ln.some(Ha(o,e,r,n,t))})}}}));return(r=(e=i).ltr()).collapsed?e.rtl().filter(function(n){return!1===n.collapsed}).map(function(n){return za.rtl(kn.fromDom(n.endContainer),n.endOffset,kn.fromDom(n.startContainer),n.startOffset)}).getOrThunk(function(){return fa(0,za.ltr,r)}):fa(0,za.ltr,r)}function ma(n,t,e){return t>=n.left&&t<=n.right&&e>=n.top&&e<=n.bottom}function ga(n,t){return t-n.left<n.right-t}function pa(n,t,e){var r=n.dom().createRange();return r.selectNode(t.dom()),r.collapse(e),r}function ha(n,t,e){return(0===Qn.children(t).length?function(n,t,e){var r=t.dom().getBoundingClientRect(),o=ga(r,e);return ln.some(pa(n,t,o))}:function(t,n,e){var r=t.dom().createRange();r.selectNode(n.dom());var o=r.getBoundingClientRect(),i=ga(o,e);return(!0===i?ge:pe)(n).map(function(n){return pa(t,n,i)})})(n,t,e)}function va(n,t){var e=it.name(n);return"input"===e?Ba.after(n):hn.contains(["br","img"],e)?0===t?Ba.before(n):Ba.after(n):Ba.on(n,t)}function ba(n,t){var e=n.fold(Ba.before,va,Ba.after),r=t.fold(Ba.before,va,Ba.after);return Wa.relative(e,r)}function wa(n,t,e,r){var o=va(n,t),i=va(e,r);return Wa.relative(o,i)}function ya(n,t){ln.from(n.getSelection()).each(function(n){n.removeAllRanges(),n.addRange(t)})}function xa(n,t,e,r,o){var i=Ha(n,t,e,r,o);ya(n,i)}function Ca(i,n){return _a(i,n).match({ltr:function(n,t,e,r){xa(i,n,t,e,r)},rtl:function(n,t,e,r){var o=i.getSelection();o.setBaseAndExtent?o.setBaseAndExtent(n.dom(),t,e.dom(),r):o.extend?(o.collapse(n.dom(),t),o.extend(e.dom(),r)):xa(i,e,r,n,t)}})}function Ra(n){var t=kn.fromDom(n.anchorNode),e=kn.fromDom(n.focusNode);return ca(t,n.anchorOffset,e,n.focusOffset)?ln.some(Wa.range(kn.fromDom(n.anchorNode),n.anchorOffset,kn.fromDom(n.focusNode),n.focusOffset)):function(n){if(0<n.rangeCount){var t=n.getRangeAt(0),e=n.getRangeAt(n.rangeCount-1);return ln.some(Wa.range(kn.fromDom(t.startContainer),t.startOffset,kn.fromDom(e.endContainer),e.endOffset))}return ln.none()}(n)}function Sa(n){return function(n){return ln.from(n.getSelection()).filter(function(n){return 0<n.rangeCount}).bind(Ra)}(n).map(function(n){return Wa.exact(n.start(),n.soffset(),n.finish(),n.foffset())})}function Ta(n){function t(n,t,e,r){return Ha(o,n,t,e,r)}var o=Wa.getWin(n).dom(),e=function(n){return n.match({domRange:function(n){var t=kn.fromDom(n.startContainer),e=kn.fromDom(n.endContainer);return wa(t,n.startOffset,e,n.endOffset)},relative:ba,exact:wa})}(n);return _a(o,e).match({ltr:t,rtl:t})}function Da(n,t,e){return function(n,t,e){var r=kn.fromDom(n.document);return Ga(r,t,e).map(function(n){return Wa.range(kn.fromDom(n.startContainer),n.startOffset,kn.fromDom(n.endContainer),n.endOffset)})}(n,t,e)}function ka(n,t){var e=Wa.exact(t,0,t,0);return Ta(e)}function Aa(t,e,r,o){if(t.keyCode===Xa.TAB){var i=ri(e),u=function(n){var t=it.name(n);return Zn.eq(n,i)||hn.contains(Za,t)},n=e.selection.getRng();if(n.collapsed){var a=kn.fromDom(n.startContainer);Xt(a,u).each(function(n){t.preventDefault(),(t.shiftKey?function(n,t,e,r){return Ka(n,t,aa(e),r)}:function(n,t,e,r){return Ka(n,t,ua(e),r)})(e,u,n,r,o).each(function(n){e.selection.setRng(n)})})}}}function Na(t){return function(n){return n===t}}function Oa(n,t){var e=Fa(n,t);return{start:rn.constant(kn.fromDom(e.startContainer)),soffset:rn.constant(e.startOffset),finish:rn.constant(kn.fromDom(e.endContainer)),foffset:rn.constant(e.endOffset)}}function Ia(n,t,e,r){return{start:rn.constant(Ba.on(n,t)),finish:rn.constant(Ba.on(e,r))}}var Pa=Me([{before:["element"]},{on:["element","offset"]},{after:["element"]}]),Ba={before:Pa.before,on:Pa.on,after:Pa.after,cata:function(n,t,e,r){return n.fold(t,e,r)},getStart:function(n){return n.fold(rn.identity,rn.identity,rn.identity)}},Ea=Me([{domRange:["rng"]},{relative:["startSitu","finishSitu"]},{exact:["start","soffset","finish","foffset"]}]),Ma=wn.immutable("start","soffset","finish","foffset"),Wa={domRange:Ea.domRange,relative:Ea.relative,exact:Ea.exact,exactFromRange:function(n){return Ea.exact(n.start(),n.soffset(),n.finish(),n.foffset())},range:Ma,getWin:function(n){var t=n.match({domRange:function(n){return kn.fromDom(n.startContainer)},relative:function(n,t){return Ba.getStart(n)},exact:function(n,t,e,r){return n}});return Qn.defaultView(t)}},ja=function(n,t){var e=n.document.createRange();return la(e,t),e},qa=function(n,t,e){var r,o,i=n.document.createRange();return r=i,t.fold(function(n){r.setStartBefore(n.dom())},function(n,t){r.setStart(n.dom(),t)},function(n){r.setStartAfter(n.dom())}),o=i,e.fold(function(n){o.setEndBefore(n.dom())},function(n,t){o.setEnd(n.dom(),t)},function(n){o.setEndAfter(n.dom())}),i},Ha=function(n,t,e,r,o){var i=n.document.createRange();return i.setStart(t.dom(),e),i.setEnd(r.dom(),o),i},La=function(n){var t=n.getClientRects(),e=0<t.length?t[0]:n.getBoundingClientRect();return 0<e.width||0<e.height?ln.some(e).map(sa):ln.none()},za=Me([{ltr:["start","soffset","finish","foffset"]},{rtl:["start","soffset","finish","foffset"]}]),_a=(za.ltr,za.rtl,da),Fa=function(i,n){return da(i,n).match({ltr:function(n,t,e,r){var o=i.document.createRange();return o.setStart(n.dom(),t),o.setEnd(e.dom(),r),o},rtl:function(n,t,e,r){var o=i.document.createRange();return o.setStart(e.dom(),r),o.setEnd(n.dom(),t),o}})},Va=function(l,s,f,d){var n=l.dom().createRange();n.selectNode(s.dom());var t=n.getClientRects();return Ur(t,function(n){return ma(n,f,d)?ln.some(n):ln.none()}).map(function(n){return e=l,t=f,o=d,i=n,u=function(n){var t=e.dom().createRange();return t.setStart(r.dom(),n),t.collapse(!0),t},a=fe.get(r=s).length,c=function(n,t,e,r,o){if(0===o)return 0;if(t===r)return o-1;for(var i=r,u=1;u<o;u++){var a=n(u),c=Math.abs(t-a.left);if(e>a.bottom);else{if(e<a.top||i<c)return u-1;i=c}}return 0}(function(n){return u(n).getBoundingClientRect()},t,o,i.right,a),u(c);var e,r,t,o,i,u,a,c})},Ua=function(n,t,e,r){return(it.isText(t)?Va:function(t,n,e,r){var o=t.dom().createRange(),i=Qn.children(n);return Ur(i,function(n){return o.selectNode(n.dom()),ma(o.getBoundingClientRect(),e,r)?Ua(t,n,e,r):ln.none()})})(n,t,e,r)},Ga=document.caretPositionFromPoint?function(e,n,t){return ln.from(e.dom().caretPositionFromPoint(n,t)).bind(function(n){if(null===n.offsetNode)return ln.none();var t=e.dom().createRange();return t.setStart(n.offsetNode,n.offset),t.collapse(),ln.some(t)})}:document.caretRangeFromPoint?function(n,t,e){return ln.from(n.dom().caretRangeFromPoint(t,e))}:function(e,r,o){return kn.fromPoint(e,r,o).bind(function(n){function t(){return ha(e,n,r)}return 0===Qn.children(n).length?t():function(n,t,e,r){var o=n.dom().createRange();o.selectNode(t.dom());var i=o.getBoundingClientRect();return function(n,t,e,r){var o=n.dom().createRange();o.selectNode(t.dom());var i=o.getBoundingClientRect(),u=Math.max(i.left,Math.min(i.right,e)),a=Math.max(i.top,Math.min(i.bottom,r));return Ua(n,t,u,a)}(n,t,Math.max(i.left,Math.min(i.right,e)),Math.max(i.top,Math.min(i.bottom,r)))}(e,n,r,o).orThunk(t)})},Ya=ba,Ja=wa,Xa=tinymce.util.Tools.resolve("tinymce.util.VK"),Ka=function(o,n,t,i,e){return t.fold(ln.none,ln.none,function(n,t){return ge(t).map(function(n){return ka(0,n)})},function(r){return Zt(r,n).bind(function(n){var t,e=$e.noMenu(r);return o.undoManager.transact(function(){i.insertRowsAfter(n,e)}),t=dt.descendants(n,"tr"),hn.last(t).bind(function(n){return Jt.descendant(n,"td,th").map(function(n){return ka(0,n)})})})})},Za=["table","li","dl"],$a={response:wn.immutable("selection","kill")},Qa=Na(38),nc=Na(40),tc={ltr:{isBackward:Na(37),isForward:Na(39)},rtl:{isBackward:Na(39),isForward:Na(37)},isUp:Qa,isDown:nc,isNavigation:function(n){return 37<=n&&n<=40}},ec=(Xn.detect().browser.isSafari(),function(n){var t=void 0!==n?n.dom():document,e=t.body.scrollLeft||t.documentElement.scrollLeft,r=t.body.scrollTop||t.documentElement.scrollTop;return Dr(e,r)});function rc(i){return{elementFromPoint:function(n,t){return kn.fromPoint(kn.fromDom(i.document),n,t)},getRect:function(n){return n.dom().getBoundingClientRect()},getRangedRect:function(n,t,e,r){var o=Wa.exact(n,t,e,r);return function(n,t){var e=Fa(n,t);return La(e)}(i,o).map(function(n){return bn.map(n,rn.apply)})},getSelection:function(){return Sa(i).map(function(n){return Oa(i,n)})},fromSitus:function(n){var t=Wa.relative(n.start(),n.finish());return Oa(i,t)},situsFromPoint:function(n,t){return Da(i,n,t).map(function(n){return{start:rn.constant(Ba.on(n.start(),n.soffset())),finish:rn.constant(Ba.on(n.finish(),n.foffset()))}})},clearSelection:function(){!function(n){n.getSelection().removeAllRanges()}(i)},setSelection:function(n){!function(n,t,e,r,o){var i=Ja(t,e,r,o);Ca(n,i)}(i,n.start(),n.soffset(),n.finish(),n.foffset())},setRelativeSelection:function(n,t){!function(n,t,e){var r=Ya(t,e);Ca(n,r)}(i,n,t)},selectContents:function(n){!function(n,t){var e=ja(n,t);ya(n,e)}(i,n)},getInnerHeight:function(){return i.innerHeight},getScrollY:function(){return ec(kn.fromDom(i.document)).top()},scrollBy:function(n,t){!function(n,t,e){(void 0!==e?e.dom():document).defaultView.scrollBy(n,t)}(n,t,kn.fromDom(i.document))}}}function oc(e,n,r,t,o){return Zn.eq(r,t)?ln.none():Ge(r,t,n).bind(function(n){var t=n.boxes().getOr([]);return 0<t.length?(o(e,t,n.start(),n.finish()),ln.some($a.response(ln.some(Ia(r,0,r,me(r))),!0))):ln.none()})}function ic(n){return Ic.nu({left:n.left,top:n.top,right:n.right,bottom:n.bottom})}function uc(n,t){return ln.some(n.getRect(t))}function ac(n,t,e){return it.isElement(t)?uc(n,t).map(ic):it.isText(t)?(r=n,o=t,0<=(i=e)&&i<me(o)?r.getRangedRect(o,i,o,i+1):0<i?r.getRangedRect(o,i-1,o,i):ln.none()).map(ic):ln.none();var r,o,i}function cc(n,t){return it.isElement(t)?uc(n,t).map(ic):it.isText(t)?n.getRangedRect(t,0,t,me(t)).map(ic):ln.none()}function lc(n,t,e,r){var o=void 0!==r?r:Bc;return n.property().parent(t).map(function(n){return Pc(n,o)})}function sc(n,t){return 0===n.property().children(t).length}function fc(n,t,e,r){return function(n,t,e,r){return Hc(n,t,e,jc.sidestep,qc.left(),r)}(n,t,e,r)}function dc(n,t,e,r){return function(n,t,e,r){return Hc(n,t,e,jc.sidestep,qc.right(),r)}(n,t,e,r)}function mc(t,n,r){return Yt.closest(n,Lr).fold(rn.constant(!1),function(n){return cc(t,n).exists(function(n){return e=n,(t=r).left()<e.left()||Math.abs(e.right()-t.left())<1||t.left()>e.right();var t,e})})}function gc(t,e,n){var r,o,i,u=t.move(n,5),a=Gc(e,t,n,u,100).getOr(u);return(o=a,i=e,(r=t).point(o)>i.getInnerHeight()?ln.some(r.point(o)-i.getInnerHeight()):r.point(o)<0?ln.some(-r.point(o)):ln.none()).fold(function(){return e.situsFromPoint(a.left(),t.point(a))},function(n){return e.scrollBy(0,n),e.situsFromPoint(a.left(),t.point(a)-n)})}function pc(n){return Jt.closest(n,"tr")}function hc(r){return Qn.parent(r).bind(function(t){var e=Qn.children(t);return function(n,t){return hn.findIndex(n,rn.curry(Zn.eq,t))}(e,r).map(function(n){return Zc(t,e,r,n)})})}function vc(n){return"br"===it.name(n)}function bc(n,t,e,r){var o,i,u;return(vc(t)?(o=n,i=t,(u=r).traverse(i).orThunk(function(){return $c(i,u.gather,o)}).map(u.relative)):function(t,n,e,r){return Qn.child(o=n,i=e).filter(vc).orThunk(function(){return Qn.child(o,i-1).filter(vc)}).bind(function(n){return r.traverse(n).fold(function(){return $c(n,r.gather,t).map(r.relative)},function(n){return hc(n).map(function(n){return Ba.on(n.parent(),n.index())})})});var o,i}(n,t,e,r)).map(function(n){return{start:rn.constant(n),finish:rn.constant(n)}})}function wc(t,e,r){return(i=e,u=r,(o=t).getSelection().bind(function(e){return bc(i,e.finish(),e.foffset(),u).fold(function(){return ln.some(Kc.point(e.finish(),e.foffset()))},function(n){var t=o.fromSitus(n);return function(n){return Xc.cata(n,function(n){return ln.none()},function(){return ln.none()},function(n){return ln.some(Kc.point(n,0))},function(n){return ln.some(Kc.point(n,me(n)))})}(Xc.verify(o,e.finish(),e.foffset(),t.finish(),t.foffset(),u.failure,i))})})).bind(function(n){return nl(t,e,n.element(),n.offset(),r,20).map(t.fromSitus)});var o,i,u}function yc(r,o,i,n,u){return Jt.closest(n,"td,th",o).bind(function(e){return Jt.closest(e,"table",o).bind(function(n){return t=n,function(n,t,e){return Yt.ancestor(n,t,e).isSome()}(u,function(n){return Qn.parent(n).exists(function(n){return Zn.eq(n,t)})})?wc(r,o,i).bind(function(t){return Jt.closest(t.finish(),"td,th",o).map(function(n){return{start:rn.constant(e),finish:rn.constant(n),range:rn.constant(t)}})}):ln.none();var t})})}function xc(n,t,e,r,o,i){return ol.browser.isIE()?ln.none():i(r,t).orThunk(function(){return yc(n,t,e,r,o).map(function(n){var t=n.range();return $a.response(ln.some(Ia(t.start(),t.soffset(),t.finish(),t.foffset())),!0)})})}function Cc(n,t,e,r,o,i,u){return yc(n,e,r,o,i).bind(function(n){return Ac(t,e,n.start(),n.finish(),u)})}function Rc(n,r){return Jt.closest(n,"tr",r).bind(function(e){return Jt.closest(e,"table",r).bind(function(n){var t=dt.descendants(n,"tr");return Zn.eq(e,t[0])?_c.seekLeft(n,function(n){return pe(n).isSome()},r).map(function(n){var t=me(n);return $a.response(ln.some(Ia(n,t,n,t)),!0)}):ln.none()})})}function Sc(n,r){return Jt.closest(n,"tr",r).bind(function(e){return Jt.closest(e,"table",r).bind(function(n){var t=dt.descendants(n,"tr");return Zn.eq(e,t[t.length-1])?_c.seekRight(n,function(n){return ge(n).isSome()},r).map(function(n){return $a.response(ln.some(Ia(n,0,n,0)),!0)}):ln.none()})})}function Tc(n,t){return Jt.closest(n,"td,th",t)}function Dc(n){return!1===nu(kn.fromDom(n.target),"ephox-snooker-resizer-bar")}var kc=function(e,r,n,t,o,i,u){return Zn.eq(n,o)&&t===i?ln.none():Jt.closest(n,"td,th",r).bind(function(t){return Jt.closest(o,"td,th",r).bind(function(n){return oc(e,r,t,n,u)})})},Ac=oc,Nc=function(n,t,e,r,o){return function(n,t,e,r,o){return(i=n,u=o,hn.find(i,function(n){return An.is(n,u)})).bind(function(n){return Ae(n,t,e).bind(function(n){return e=r,Jt.ancestor(t=n,"table").bind(function(n){return Jt.descendant(n,e).bind(function(n){return Ie(n,t).bind(function(t){return t.boxes().map(function(n){return{boxes:rn.constant(n),start:rn.constant(t.start()),finish:rn.constant(t.finish())}})})})});var t,e})});var i,u}(r,n,t,o.firstSelectedSelector(),o.lastSelectedSelector()).map(function(n){return o.clear(e),o.selectRange(e,n.boxes(),n.start(),n.finish()),n.boxes()})},Oc=wn.immutableBag(["left","top","right","bottom"],[]),Ic={nu:Oc,moveUp:function(n,t){return Oc({left:n.left(),top:n.top()-t,right:n.right(),bottom:n.bottom()-t})},moveDown:function(n,t){return Oc({left:n.left(),top:n.top()+t,right:n.right(),bottom:n.bottom()+t})},moveBottomTo:function(n,t){var e=n.bottom()-n.top();return Oc({left:n.left(),top:t-e,right:n.right(),bottom:t})},moveTopTo:function(n,t){var e=n.bottom()-n.top();return Oc({left:n.left(),top:t,right:n.right(),bottom:t+e})},getTop:function(n){return n.top()},getBottom:function(n){return n.bottom()},translate:function(n,t,e){return Oc({left:n.left()+t,top:n.top()+e,right:n.right()+t,bottom:n.bottom()+e})},toString:function(n){return"("+n.left()+", "+n.top()+") -> ("+n.right()+", "+n.bottom()+")"}},Pc=wn.immutable("item","mode"),Bc=function(n,t,e,r){var o=void 0!==r?r:Ec;return e.sibling(n,t).map(function(n){return Pc(n,o)})},Ec=function(n,t,e,r){var o=void 0!==r?r:Ec,i=n.property().children(t);return e.first(i).map(function(n){return Pc(n,o)})},Mc=[{current:lc,next:Bc,fallback:ln.none()},{current:Bc,next:Ec,fallback:ln.some(lc)},{current:Ec,next:Ec,fallback:ln.some(Bc)}],Wc=function(t,e,r,o,n){return n=void 0!==n?n:Mc,hn.find(n,function(n){return n.current===r}).bind(function(n){return n.current(t,e,o,n.next).orThunk(function(){return n.fallback.bind(function(n){return Wc(t,e,n,o)})})})},jc={backtrack:lc,sidestep:Bc,advance:Ec,go:Wc},qc={left:function(){return{sibling:function(n,t){return n.query().prevSibling(t)},first:function(n){return 0<n.length?ln.some(n[n.length-1]):ln.none()}}},right:function(){return{sibling:function(n,t){return n.query().nextSibling(t)},first:function(n){return 0<n.length?ln.some(n[0]):ln.none()}}}},Hc=function(t,n,e,r,o,i){return jc.go(t,n,r,o).bind(function(n){return i(n.item())?ln.none():e(n.item())?ln.some(n.item()):Hc(t,n.item(),e,n.mode(),o,i)})},Lc={before:function(n,t,e){return fc(n,t,rn.curry(sc,n),e)},after:function(n,t,e){return dc(n,t,rn.curry(sc,n),e)},seekLeft:fc,seekRight:dc,walkers:function(){return{left:qc.left,right:qc.right}},walk:function(n,t,e,r,o){return jc.go(n,t,e,r,o)},backtrack:jc.backtrack,sidestep:jc.sidestep,advance:jc.advance},zc=ve(),_c={gather:function(n,t,e){return Lc.gather(zc,n,t,e)},before:function(n,t){return Lc.before(zc,n,t)},after:function(n,t){return Lc.after(zc,n,t)},seekLeft:function(n,t,e){return Lc.seekLeft(zc,n,t,e)},seekRight:function(n,t,e){return Lc.seekRight(zc,n,t,e)},walkers:function(){return Lc.walkers()},walk:function(n,t,e,r){return Lc.walk(zc,n,t,e,r)}},Fc=Me([{none:[]},{retry:["caret"]}]),Vc={point:Ic.getTop,adjuster:function(n,t,e,r,o){var i=Ic.moveUp(o,5);return Math.abs(e.top()-r.top())<1?Fc.retry(i):e.bottom()<o.top()?Fc.retry(i):e.bottom()===o.top()?Fc.retry(Ic.moveUp(o,1)):mc(n,t,o)?Fc.retry(Ic.translate(i,5,0)):Fc.none()},move:Ic.moveUp,gather:_c.before},Uc={point:Ic.getBottom,adjuster:function(n,t,e,r,o){var i=Ic.moveDown(o,5);return Math.abs(e.bottom()-r.bottom())<1?Fc.retry(i):e.top()>o.bottom()?Fc.retry(i):e.top()===o.bottom()?Fc.retry(Ic.moveDown(o,1)):mc(n,t,o)?Fc.retry(Ic.translate(i,5,0)):Fc.none()},move:Ic.moveDown,gather:_c.after},Gc=function(e,r,o,i,u){return 0===u?ln.some(i):(c=e,l=i.left(),s=r.point(i),c.elementFromPoint(l,s).filter(function(n){return"table"===it.name(n)}).isSome()?(t=i,a=u-1,Gc(e,n=r,o,n.move(t,5),a)):e.situsFromPoint(i.left(),r.point(i)).bind(function(n){return n.start().fold(ln.none,function(t,n){return cc(e,t).bind(function(n){return r.adjuster(e,t,n,o,i).fold(ln.none,function(n){return Gc(e,r,o,n,u-1)})}).orThunk(function(){return ln.some(i)})},ln.none)}));var n,t,a,c,l,s},Yc={tryUp:rn.curry(gc,Vc),tryDown:rn.curry(gc,Uc),ieTryUp:function(n,t){return n.situsFromPoint(t.left(),t.top()-5)},ieTryDown:function(n,t){return n.situsFromPoint(t.left(),t.bottom()+5)},getJumpSize:rn.constant(5)},Jc=Me([{none:["message"]},{success:[]},{failedUp:["cell"]},{failedDown:["cell"]}]),Xc={verify:function(a,n,t,e,r,c,o){return Jt.closest(e,"td,th",o).bind(function(u){return Jt.closest(n,"td,th",o).map(function(i){return Zn.eq(u,i)?Zn.eq(e,u)&&me(u)===r?c(i):Jc.none("in same cell"):_e(pc,[u,i]).fold(function(){return t=i,e=u,r=(n=a).getRect(t),(o=n.getRect(e)).right>r.left&&o.left<r.right?Jc.success():c(i);var n,t,e,r,o},function(n){return c(i)})})}).getOr(Jc.none("default"))},cata:function(n,t,e,r,o){return n.fold(t,e,r,o)},adt:Jc},Kc={point:wn.immutable("element","offset"),delta:wn.immutable("element","deltaOffset"),range:wn.immutable("element","start","finish"),points:wn.immutable("begin","end"),text:wn.immutable("element","text")},Zc=(wn.immutable("ancestor","descendants","element","index"),wn.immutable("parent","children","element","index")),$c=function(n,t,e){return t(n,e).bind(function(n){return it.isText(n)&&0===fe.get(n).trim().length?$c(n,t,e):ln.some(n)})},Qc=Xn.detect(),nl=function(r,o,i,u,a,c){return 0===c?ln.none():rl(r,o,i,u,a).bind(function(n){var t=r.fromSitus(n),e=Xc.verify(r,i,u,t.finish(),t.foffset(),a.failure,o);return Xc.cata(e,function(){return ln.none()},function(){return ln.some(n)},function(n){return Zn.eq(i,n)&&0===u?tl(r,i,u,Ic.moveUp,a):nl(r,o,n,0,a,c-1)},function(n){return Zn.eq(i,n)&&u===me(n)?tl(r,i,u,Ic.moveDown,a):nl(r,o,n,me(n),a,c-1)})})},tl=function(t,n,e,r,o){return ac(t,n,e).bind(function(n){return el(t,o,r(n,Yc.getJumpSize()))})},el=function(n,t,e){return Qc.browser.isChrome()||Qc.browser.isSafari()||Qc.browser.isFirefox()||Qc.browser.isEdge()?t.otherRetry(n,e):Qc.browser.isIE()?t.ieRetry(n,e):ln.none()},rl=function(t,n,e,r,o){return ac(t,e,r).bind(function(n){return el(t,o,n)})},ol=Xn.detect(),il={down:{traverse:Qn.nextSibling,gather:_c.after,relative:Ba.before,otherRetry:Yc.tryDown,ieRetry:Yc.ieTryDown,failure:Xc.adt.failedDown},up:{traverse:Qn.prevSibling,gather:_c.before,relative:Ba.before,otherRetry:Yc.tryUp,ieRetry:Yc.ieTryUp,failure:Xc.adt.failedUp}},ul=wn.immutable("rows","cols"),al=function(n,t,e,r){var o,i,u,a,c,l,s=rc(n),f=(o=s,i=t,u=e,a=r,c=ln.none(),l=function(){c=ln.none()},{mousedown:function(n){a.clear(i),c=Tc(n.target(),u)},mouseover:function(n){c.each(function(r){a.clear(i),Tc(n.target(),u).each(function(e){Ge(r,e,u).each(function(n){var t=n.boxes().getOr([]);(1<t.length||1===t.length&&!Zn.eq(r,e))&&(a.selectRange(i,t,n.start(),n.finish()),o.selectContents(e))})})})},mouseup:function(){c.each(l)}});return{mousedown:f.mousedown,mouseover:f.mouseover,mouseup:f.mouseup}},cl=function(n,c,l,s){function f(){return s.clear(c),ln.none()}var d=rc(n);return{keydown:function(n,t,e,r,o,i){var u=n.raw().which,a=!0===n.raw().shiftKey;return Pe(c,s.selectedSelector()).fold(function(){return tc.isDown(u)&&a?rn.curry(Cc,d,c,l,il.down,r,t,s.selectRange):tc.isUp(u)&&a?rn.curry(Cc,d,c,l,il.up,r,t,s.selectRange):tc.isDown(u)?rn.curry(xc,d,l,il.down,r,t,Sc):tc.isUp(u)?rn.curry(xc,d,l,il.up,r,t,Rc):ln.none},function(t){function n(n){return function(){return Ur(n,function(n){return Nc(n.rows(),n.cols(),c,t,s)}).fold(function(){return Be(c,s.firstSelectedSelector(),s.lastSelectedSelector()).map(function(n){var t=tc.isDown(u)||i.isForward(u)?Ba.after:Ba.before;return d.setRelativeSelection(Ba.on(n.first(),0),t(n.table())),s.clear(c),$a.response(ln.none(),!0)})},function(n){return ln.some($a.response(ln.none(),!0))})}}return tc.isDown(u)&&a?n([ul(1,0)]):tc.isUp(u)&&a?n([ul(-1,0)]):i.isBackward(u)&&a?n([ul(0,-1),ul(-1,0)]):i.isForward(u)&&a?n([ul(0,1),ul(1,0)]):tc.isNavigation(u)&&!1==a?f:ln.none})()},keyup:function(t,e,r,o,i){return Pe(c,s.selectedSelector()).fold(function(){var n=t.raw().which;return 0==(!0===t.raw().shiftKey)?ln.none():tc.isNavigation(n)?kc(c,l,e,r,o,i,s.selectRange):ln.none()},ln.none)}}},ll=function(o){function e(n){ut.remove(n,o.selected()),ut.remove(n,o.firstSelected()),ut.remove(n,o.lastSelected())}function i(n){ut.set(n,o.selected(),"1")}function u(n){var t=dt.descendants(n,o.selectedSelector());hn.each(t,e)}return{clear:u,selectRange:function(n,t,e,r){u(n),hn.each(t,i),ut.set(e,o.firstSelected(),"1"),ut.set(r,o.lastSelected(),"1")},selectedSelector:o.selectedSelector,firstSelectedSelector:o.firstSelectedSelector,lastSelectedSelector:o.lastSelectedSelector}};var sl=Du.each;en.add("table",function(t){var n,e=ta(t),r=function(p,h){var v=wn.immutableBag(["mousedown","mouseover","mouseup","keyup","keydown"],[]),b=ln.none(),w=ll(Ye);return p.on("init",function(n){function a(n,t){!0===n.raw().shiftKey&&(t.kill()&&n.kill(),t.selection().each(function(n){var t=Wa.relative(n.start(),n.finish()),e=Fa(l,t);p.selection.setRng(e)}))}function t(n){var t=g(n);if(t.raw().shiftKey&&tc.isNavigation(t.raw().which)){var e=p.selection.getRng(),r=kn.fromDom(e.startContainer),o=kn.fromDom(e.endContainer);m.keyup(t,r,e.startOffset,o,e.endOffset).each(function(n){a(t,n)})}}function e(n){var t=g(n);h().each(function(n){n.hideBars()});var e=p.selection.getRng(),r=kn.fromDom(p.selection.getStart()),o=kn.fromDom(e.startContainer),i=kn.fromDom(e.endContainer),u=Cu(r).isRtl()?tc.rtl:tc.ltr;m.keydown(t,o,e.startOffset,i,e.endOffset,u).each(function(n){a(t,n)}),h().each(function(n){n.showBars()})}function i(n){return n.hasOwnProperty("x")&&n.hasOwnProperty("y")}function r(n){return 0===n.button}function o(n){r(n)&&Dc(n)&&d.mousedown(g(n))}function u(n){var t;void 0!==(t=n).buttons&&0==(1&t.buttons)||!Dc(n)||d.mouseover(g(n))}function c(n){r(n)&&Dc(n)&&d.mouseup(g(n))}var l=p.getWin(),s=ri(p),f=ui(p),d=al(l,s,f,w),m=cl(l,s,f,w),g=function(n){function t(){n.stopPropagation()}function e(){n.preventDefault()}var r=kn.fromDom(n.target),o=rn.compose(e,t);return{target:rn.constant(r),x:rn.constant(i(n)?n.x:null),y:rn.constant(i(n)?n.y:null),stop:t,prevent:e,kill:o,raw:rn.constant(n)}};p.on("mousedown",o),p.on("mouseover",u),p.on("mouseup",c),p.on("keyup",t),p.on("keydown",e),p.on("nodechange",function(){var n=p.selection,t=kn.fromDom(n.getStart()),e=kn.fromDom(n.getEnd());_e(Zt,[t,e]).fold(function(){w.clear(s)},rn.noop)}),b=ln.some(v({mousedown:o,mouseover:u,mouseup:c,keyup:t,keydown:e}))}),{clear:w.clear,destroy:function(){b.each(function(n){})}}}(t,e.lazyResize),o=function(s,n){function e(n){return"table"===it.name(ri(n))}function t(u,a,c,l){return function(n,t){ci(n);var e=l(),r=kn.fromDom(s.getDoc()),o=Br(Cu),i=zt(c,r,f);return a(n)?u(e,n,t,i,o).bind(function(n){return hn.each(n.newRows(),function(n){bi(s,n.dom())}),hn.each(n.newCells(),function(n){wi(s,n.dom())}),n.cursor().map(function(n){var t=s.dom.createRng();return t.setStart(n.dom(),0),t.setEnd(n.dom(),0),t})}):ln.none()}}var r,f=(r=s.getParam("table_clone_elements"),sn.isString(r)?ln.some(r.split(/[ ,]/)):Array.isArray(r)?ln.some(r):ln.none());return{deleteRow:t(bu.eraseRows,function(n){var t=Er(n);return!1===e(s)||1<t.rows()},rn.noop,n),deleteColumn:t(bu.eraseColumns,function(n){var t=Er(n);return!1===e(s)||1<t.columns()},rn.noop,n),insertRowsBefore:t(bu.insertRowsBefore,rn.always,rn.noop,n),insertRowsAfter:t(bu.insertRowsAfter,rn.always,rn.noop,n),insertColumnsBefore:t(bu.insertColumnsBefore,rn.always,lr,n),insertColumnsAfter:t(bu.insertColumnsAfter,rn.always,lr,n),mergeCells:t(bu.mergeCells,rn.always,rn.noop,n),unmergeCells:t(bu.unmergeCells,rn.always,rn.noop,n),pasteRowsBefore:t(bu.pasteRowsBefore,rn.always,rn.noop,n),pasteRowsAfter:t(bu.pasteRowsAfter,rn.always,rn.noop,n),pasteCells:t(bu.pasteCells,rn.always,rn.noop,n)}}(t,e.lazyWire),i=(n=t,{get:function(){return function(n,t){return Pe(n,t)}(ri(n),Ye.selectedSelector()).fold(function(){return void 0===n.selection.getStart()?Xe.none():Xe.single(n.selection)},function(n){return Xe.multiple(n)})}}),u=Pi(ln.none());return function(a,t,c,l,e){function r(){return kn.fromDom(a.dom.getParent(a.selection.getStart(),"th,td"))}function s(n){return Zt(n,d)}function f(n){return{width:oi(n.dom()),height:oi(n.dom())}}function o(t){var e=r();s(e).each(function(i){var n=$e.forMenu(l,i,e),u=f(i);t(i,n).each(function(n){var t,e,r,o;t=a,e=u,o=f(r=i),e.width===o.width&&e.height===o.height||(yi(t,r.dom(),e.width,e.height),xi(t,r.dom(),o.width,o.height)),a.selection.setRng(n),a.focus(),c.clear(i),ci(i)})})}function i(n){var o=r();return s(o).bind(function(n){var t=kn.fromDom(a.getDoc()),e=$e.forMenu(l,n,o),r=zt(rn.noop,t,ln.none());return Ci(n,e,r)})}function u(u){e.get().each(function(n){var o=hn.map(n,function(n){return le(n)}),i=r();s(i).bind(function(t){var n=kn.fromDom(a.getDoc()),e=_t(n),r=$e.pasteRows(l,t,i,o,e);u(t,r).each(function(n){a.selection.setRng(n),a.focus(),c.clear(t)})})})}var d=ui(a);qu({mceTableSplitCells:function(){o(t.unmergeCells)},mceTableMergeCells:function(){o(t.mergeCells)},mceTableInsertRowBefore:function(){o(t.insertRowsBefore)},mceTableInsertRowAfter:function(){o(t.insertRowsAfter)},mceTableInsertColBefore:function(){o(t.insertColumnsBefore)},mceTableInsertColAfter:function(){o(t.insertColumnsAfter)},mceTableDeleteCol:function(){o(t.deleteColumn)},mceTableDeleteRow:function(){o(t.deleteRow)},mceTableCutRow:function(n){e.set(i()),o(t.deleteRow)},mceTableCopyRow:function(n){e.set(i())},mceTablePasteRowBefore:function(n){u(t.pasteRowsBefore)},mceTablePasteRowAfter:function(n){u(t.pasteRowsAfter)},mceTableDelete:function(){var n=kn.fromDom(a.dom.getParent(a.selection.getStart(),"th,td"));Zt(n,d).filter(rn.not(d)).each(function(n){var t=kn.fromText("");ie.after(n,t),ae.remove(n);var e=a.dom.createRng();e.setStart(t.dom(),0),e.setEnd(t.dom(),0),a.selection.setRng(e)})}},function(n,t){a.addCommand(t,n)}),qu({mceInsertTable:rn.curry(Wu,a),mceTableProps:rn.curry(Wu,a,!0),mceTableRowProps:rn.curry(Nu,a),mceTableCellProps:rn.curry(Ii,a)},function(e,n){a.addCommand(n,function(n,t){e(t)})})}(t,o,r,i,u),qe(t,i,o,r),function(o,e){function r(n){n.disabled(!0)}function i(n){n.disabled(!1)}function n(){var t=this;a.push(t),u.fold(function(){r(t)},function(n){i(t)})}function t(){var t=this;c.push(t),u.fold(function(){r(t)},function(n){i(t)})}var u=ln.none(),a=[],c=[],l=[],s=[];o.on("init",function(){o.on("nodechange",function(n){var t=ln.from(o.dom.getParent(o.selection.getStart(),"th,td"));(u=t.bind(function(n){var t=kn.fromDom(n);return Zt(t).map(function(n){return $e.forMenu(e,n,t)})})).fold(function(){hn.each(a,r),hn.each(c,r),hn.each(l,r),hn.each(s,r)},function(t){hn.each(a,i),hn.each(c,i),hn.each(l,function(n){n.disabled(t.mergable().isNone())}),hn.each(s,function(n){n.disabled(t.unmergable().isNone())})})})});function f(n,t,e,r){var o,i,u,a,c,l=r.getEl().getElementsByTagName("table")[0],s=r.isRtl()||"tl-tr"===r.parent().rel;for(l.nextSibling.innerHTML=t+1+" x "+(e+1),s&&(t=9-t),i=0;i<10;i++)for(o=0;o<10;o++)a=l.rows[i].childNodes[o].firstChild,c=(s?t<=o:o<=t)&&i<=e,n.dom.toggleClass(a,"mce-active",c),c&&(u=a);return u.parentNode}var d=!1===o.getParam("table_grid",!0,"boolean")?{text:"Table",icon:"table",context:"table",onclick:m("mceInsertTable")}:{text:"Table",icon:"table",context:"table",ariaHideMenu:!0,onclick:function(n){n.aria&&(this.parent().hideAll(),n.stopImmediatePropagation(),o.execCommand("mceInsertTable"))},onshow:function(){f(o,0,0,this.menu.items()[0])},onhide:function(){var n=this.menu.items()[0].getEl().getElementsByTagName("a");o.dom.removeClass(n,"mce-active"),o.dom.addClass(n[0],"mce-active")},menu:[{type:"container",html:function(){var n="";n='<table role="grid" class="mce-grid mce-grid-border" aria-readonly="true">';for(var t=0;t<10;t++){n+="<tr>";for(var e=0;e<10;e++)n+='<td role="gridcell" tabindex="-1"><a id="mcegrid'+(10*t+e)+'" href="#" data-mce-x="'+e+'" data-mce-y="'+t+'"></a></td>';n+="</tr>"}return(n+="</table>")+'<div class="mce-text-center" role="presentation">1 x 1</div>'}(),onPostRender:function(){this.lastX=this.lastY=0},onmousemove:function(n){var t,e,r=n.target;"A"===r.tagName.toUpperCase()&&(t=parseInt(r.getAttribute("data-mce-x"),10),e=parseInt(r.getAttribute("data-mce-y"),10),!this.isRtl()&&"tl-tr"!==this.parent().rel||(t=9-t),t===this.lastX&&e===this.lastY||(f(o,t,e,n.control),this.lastX=t,this.lastY=e))},onclick:function(n){var t=this;"A"===n.target.tagName.toUpperCase()&&(n.preventDefault(),n.stopPropagation(),t.parent().cancel(),o.undoManager.transact(function(){Iu(o,t.lastX+1,t.lastY+1)}),o.addVisual())}}]};function m(n){return function(){o.execCommand(n)}}var g={text:"Table properties",context:"table",onPostRender:n,onclick:m("mceTableProps")},p={text:"Delete table",context:"table",onPostRender:n,cmd:"mceTableDelete"},h={text:"Row",context:"table",menu:[{text:"Insert row before",onclick:m("mceTableInsertRowBefore"),onPostRender:t},{text:"Insert row after",onclick:m("mceTableInsertRowAfter"),onPostRender:t},{text:"Delete row",onclick:m("mceTableDeleteRow"),onPostRender:t},{text:"Row properties",onclick:m("mceTableRowProps"),onPostRender:t},{text:"-"},{text:"Cut row",onclick:m("mceTableCutRow"),onPostRender:t},{text:"Copy row",onclick:m("mceTableCopyRow"),onPostRender:t},{text:"Paste row before",onclick:m("mceTablePasteRowBefore"),onPostRender:t},{text:"Paste row after",onclick:m("mceTablePasteRowAfter"),onPostRender:t}]},v={text:"Column",context:"table",menu:[{text:"Insert column before",onclick:m("mceTableInsertColBefore"),onPostRender:t},{text:"Insert column after",onclick:m("mceTableInsertColAfter"),onPostRender:t},{text:"Delete column",onclick:m("mceTableDeleteCol"),onPostRender:t}]},b={separator:"before",text:"Cell",context:"table",menu:[{text:"Cell properties",onclick:m("mceTableCellProps"),onPostRender:t},{text:"Merge cells",onclick:m("mceTableMergeCells"),onPostRender:function(){var t=this;l.push(t),u.fold(function(){r(t)},function(n){t.disabled(n.mergable().isNone())})}},{text:"Split cell",onclick:m("mceTableSplitCells"),onPostRender:function(){var t=this;s.push(t),u.fold(function(){r(t)},function(n){t.disabled(n.unmergable().isNone())})}}]};o.addMenuItem("inserttable",d),o.addMenuItem("tableprops",g),o.addMenuItem("deletetable",p),o.addMenuItem("row",h),o.addMenuItem("column",v),o.addMenuItem("cell",b)}(t,i),function(t){var e=[];function n(n){return function(){t.execCommand(n)}}sl("inserttable tableprops deletetable | cell row column".split(" "),function(n){"|"===n?e.push({text:"-"}):e.push(t.menuItems[n])}),t.addButton("table",{type:"menubutton",title:"Table",icon:"mce-table",image:"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyNCIgaGVpZ2h0%0D%0APSIyNCIgdmlld0JveD0iMCAwIDI0IDI0Ij48cGF0aCBkPSJNMCAwaDI0djI0SDB6IiBmaWxsPSJu%0D%0Ab25lIi8+PHBhdGggZD0iTTIwIDJINGMtMS4xIDAtMiAuOS0yIDJ2MTZjMCAxLjEuOSAyIDIgMmgx%0D%0ANmMxLjEgMCAyLS45IDItMlY0YzAtMS4xLS45LTItMi0yek04IDIwSDR2LTRoNHY0em0wLTZINHYt%0D%0ANGg0djR6bTAtNkg0VjRoNHY0em02IDEyaC00di00aDR2NHptMC02aC00di00aDR2NHptMC02aC00%0D%0AVjRoNHY0em02IDEyaC00di00aDR2NHptMC02aC00di00aDR2NHptMC02aC00VjRoNHY0eiIvPjwv%0D%0Ac3ZnPg==",menu:e}),t.addButton("tableprops",{title:"Table properties",onclick:n("mceTableProps"),icon:"table"}),t.addButton("tabledelete",{title:"Delete table",onclick:n("mceTableDelete")}),t.addButton("tablecellprops",{title:"Cell properties",onclick:n("mceTableCellProps")}),t.addButton("tablemergecells",{title:"Merge cells",onclick:n("mceTableMergeCells")}),t.addButton("tablesplitcells",{title:"Split cell",onclick:n("mceTableSplitCells")}),t.addButton("tableinsertrowbefore",{title:"Insert row before",onclick:n("mceTableInsertRowBefore")}),t.addButton("tableinsertrowafter",{title:"Insert row after",onclick:n("mceTableInsertRowAfter")}),t.addButton("tabledeleterow",{title:"Delete row",onclick:n("mceTableDeleteRow")}),t.addButton("tablerowprops",{title:"Row properties",onclick:n("mceTableRowProps")}),t.addButton("tablecutrow",{title:"Cut row",onclick:n("mceTableCutRow")}),t.addButton("tablecopyrow",{title:"Copy row",onclick:n("mceTableCopyRow")}),t.addButton("tablepasterowbefore",{title:"Paste row before",onclick:n("mceTablePasteRowBefore")}),t.addButton("tablepasterowafter",{title:"Paste row after",onclick:n("mceTablePasteRowAfter")}),t.addButton("tableinsertcolbefore",{title:"Insert column before",onclick:n("mceTableInsertColBefore")}),t.addButton("tableinsertcolafter",{title:"Insert column after",onclick:n("mceTableInsertColAfter")}),t.addButton("tabledeletecol",{title:"Delete column",onclick:n("mceTableDeleteCol")})}(t),function(t){var n,e=""===(n=t.getParam("table_toolbar",Ru))||!1===n?[]:sn.isString(n)?n.split(/[ ,]/):sn.isArray(n)?n:[];0<e.length&&t.addContextToolbar(function(n){return t.dom.is(n,"table")&&t.getBody().contains(n)},e.join(" "))}(t),t.on("PreInit",function(){t.serializer.addTempAttr(Ye.firstSelected()),t.serializer.addTempAttr(Ye.lastSelected())}),t.getParam("table_tab_navigation",!0,"boolean")&&t.on("keydown",function(n){Aa(n,t,o,e.lazyWire)}),t.on("remove",function(){e.destroy(),r.destroy()}),function(e,o){return{insertTable:function(n,t){return Iu(e,n,t)},setClipboardRows:function(n){return t=n,e=o,r=hn.map(t,kn.fromDom),void e.set(ln.from(r));var t,e,r},getClipboardRows:function(){return o.get().fold(function(){},function(n){return hn.map(n,function(n){return n.dom()})})}}}(t,u)})}();
